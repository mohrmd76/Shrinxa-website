<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Shrinxa â€“ Premium Packaging Solutions</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="Shrinxa is a GTA-based supplier of stretch wrap, pre-stretch film, and packaging tape with free delivery over $300 and wholesale pricing for warehouses and 3PLs." name="description"/>
<style>
    :root {
      --bg: #050914;
      --bg-alt: #0b1224;
      --accent: #1ea6ff;
      --accent-soft: rgba(30,166,255,0.12);
      --accent-strong: #0b84d1;
      --text-main: #f5f7fb;
      --text-muted: #b6bfd8;
      --card-bg: #111729;
      --border-subtle: #20273b;
      --danger: #ff4e6a;
      --success: #4cd964;
    }
    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #16345e 0, #050914 55%);
      color: var(--text-main);
      line-height: 1.5;
    }
    a { color: inherit; text-decoration: none; }
    img { max-width: 100%; display: block; }

    header {
      position: sticky;
      top: 0;
      z-index: 20;
      backdrop-filter: blur(18px);
      background: linear-gradient(90deg, rgba(5,9,20,0.96), rgba(8,16,40,0.96));
      border-bottom: 1px solid rgba(46,56,86,0.8);
    }
    .nav-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0.75rem 1.25rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.25rem;
    }
    .nav-left {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .nav-logo {
      width: 44px;
      height: 44px;
      border-radius: 999px;
      overflow: hidden;
      box-shadow: 0 0 0 2px rgba(30,166,255,0.35);
      background: #ffffff;
      padding: 4px;
    }
    .nav-logo img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .nav-brand-text {
      display: flex;
      flex-direction: column;
      gap: 0.1rem;
    }
    .nav-brand-text strong {
      letter-spacing: 0.14em;
      font-size: 0.9rem;
    }
    .nav-brand-text span {
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .nav-links {
      display: flex;
      gap: 1.25rem;
      font-size: 0.9rem;
      color: var(--text-muted);
      align-items: center;
    }
    .nav-links a {
      position: relative;
      padding-bottom: 0.15rem;
    }
    .nav-links a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--accent), #47e7ff);
      border-radius: 999px;
      transition: width 0.2s ease-out;
    }
    .nav-links a:hover::after {
      width: 100%;
    }
    .cart-chip {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.35rem 0.9rem;
      border-radius: 999px;
      background: rgba(12,25,52,0.95);
      border: 1px solid rgba(71,143,255,0.7);
      box-shadow: 0 0 0 1px rgba(16,85,204,0.4);
      font-size: 0.8rem;
      cursor: pointer;
      white-space: nowrap;
    }
    .cart-chip span.badge {
      min-width: 20px;
      height: 20px;
      border-radius: 999px;
      background: var(--accent);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 600;
      color: #001225;
    }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1.75rem 1.25rem 3.5rem;
    }

    .hero {
      display: grid;
      grid-template-columns: minmax(0, 1.5fr) minmax(0, 1.1fr);
      gap: 2.5rem;
      align-items: center;
      padding: 1.5rem 1.5rem 2.25rem;
      margin-bottom: 2.3rem;
      border-radius: 1.5rem;
      background: radial-gradient(circle at 0 0, rgba(82,180,255,0.16), transparent 60%),
                  radial-gradient(circle at 100% 100%, rgba(111,66,193,0.25), transparent 55%),
                  linear-gradient(135deg, #050814, #050814);
      border: 1px solid rgba(72,92,140,0.65);
      box-shadow:
        0 28px 80px rgba(0,0,0,0.7),
        0 0 0 1px rgba(103,135,255,0.25);
    }
    .hero-kicker {
      font-size: 0.8rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--accent);
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
    }
    .hero-kicker::before {
      content: "";
      width: 18px;
      height: 1px;
      background: linear-gradient(90deg, rgba(71,143,255,0), rgba(71,143,255,1));
      border-radius: 999px;
    }
    .hero h1 {
      font-size: clamp(2.3rem, 4vw, 2.9rem);
      margin: 0.4rem 0 0.8rem;
      letter-spacing: 0.03em;
    }
    .hero h1 span.accent {
      background: linear-gradient(90deg, #39c9ff, #e1f5ff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .hero p.lede {
      margin: 0;
      color: var(--text-muted);
      max-width: 32rem;
      font-size: 0.98rem;
    }
    .hero-cta {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-top: 1.4rem;
      align-items: center;
    }
    .btn-primary,
    .btn-ghost {
      border-radius: 999px;
      padding: 0.7rem 1.35rem;
      font-size: 0.9rem;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      font-weight: 500;
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color: #001225;
      box-shadow: 0 14px 35px rgba(22,128,219,0.6);
    }
    .btn-primary:hover { filter: brightness(1.07); }
    .btn-ghost {
      background: transparent;
      color: var(--text-muted);
      border: 1px solid rgba(88,115,178,0.8);
    }

    .hero-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 1.1rem;
      margin-top: 1.3rem;
      font-size: 0.78rem;
      color: var(--text-muted);
    }
    .hero-meta span {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }
    .hero-meta span::before {
      content: "â€¢";
      color: var(--accent);
    }

    .hero-visual {
      justify-self: center;
      position: relative;
    }
    .hero-orbit {
      width: 260px;
      height: 260px;
      border-radius: 999px;
      background: #ffffff;
      box-shadow:
        0 0 0 1px rgba(117,160,255,0.4),
        0 26px 70px rgba(0, 0, 0, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .hero-orbit img {
      width: 85%;
      height: 85%;
      object-fit: contain;
      filter: drop-shadow(0 10px 25px rgba(0,0,0,0.9));
    }
    .hero-orbit::after {
      content: "";
      position: absolute;
      inset: 15%;
      border-radius: inherit;
      border: 1px dashed rgba(209,233,255,0.18);
    }
    .hero-badge {
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      padding: 0.4rem 0.9rem;
      border-radius: 999px;
      background: rgba(5,9,20,0.96);
      border: 1px solid rgba(111,178,255,0.7);
      font-size: 0.72rem;
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      white-space: nowrap;
    }
    .hero-badge span.dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--success);
      box-shadow: 0 0 0 4px rgba(76,217,100,0.25);
    }

    .factory-hero {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(0, 1.2fr);
      gap: 1.7rem;
      margin-bottom: 2.4rem;
      align-items: center;
    }
    .factory-image-wrap {
      border-radius: 1.25rem;
      overflow: hidden;
      border: 1px solid rgba(74,108,180,0.95);
      box-shadow: 0 26px 70px rgba(0,0,0,0.9);
    }
    .factory-image-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .factory-copy h2 {
      margin: 0 0 0.4rem;
      font-size: 1.45rem;
    }
    .factory-copy p {
      margin: 0.25rem 0;
      color: var(--text-muted);
      font-size: 0.9rem;
    }
    .factory-points {
      margin-top: 0.7rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 0.6rem;
      font-size: 0.82rem;
      color: var(--text-muted);
    }
    .factory-points div {
      padding: 0.35rem 0.6rem;
      border-radius: 0.7rem;
      background: rgba(8,16,40,0.98);
      border: 1px solid rgba(54,82,150,0.9);
    }

    section { margin-bottom: 2.75rem; }
    section h2 {
      font-size: 1.6rem;
      margin-bottom: 0.4rem;
    }
    section p.section-lede {
      margin-top: 0.1rem;
      color: var(--text-muted);
      font-size: 0.9rem;
      max-width: 38rem;
    }

    .filters-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin: 1.25rem 0 1.6rem;
    }
    .pill {
      border-radius: 999px;
      border: 1px solid rgba(92,117,170,0.9);
      padding: 0.35rem 0.95rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      background: rgba(10,17,39,0.9);
      cursor: pointer;
    }
    .pill.active {
      background: var(--accent-soft);
      color: var(--accent);
      border-color: rgba(87,186,255,0.95);
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1.4rem;
    }
    .product-card {
      border-radius: 1rem;
      background: radial-gradient(circle at 0 0, rgba(74,140,232,0.18), transparent 55%),
                  var(--card-bg);
      padding: 1rem;
      border: 1px solid rgba(37,51,86,0.95);
      box-shadow: 0 16px 38px rgba(0,0,0,0.7);
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }
    .prod-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 0.75rem;
    }
    .prod-name { font-weight: 600; font-size: 1rem; }
    .prod-category {
      font-size: 0.75rem;
      padding: 0.1rem 0.55rem;
      border-radius: 999px;
      background: rgba(13,25,54,0.9);
      border: 1px solid rgba(108,141,208,0.9);
      color: var(--text-muted);
      white-space: nowrap;
    }
    .prod-image-wrap {
      margin-top: 0.25rem;
      background: radial-gradient(circle at 50% 0, rgba(180,230,255,0.18), transparent 65%);
      border-radius: 0.8rem;
      border: 1px solid rgba(40,60,110,0.9);
      padding: 0.45rem;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 130px;
    }
    .prod-image-wrap img {
      max-height: 110px;
      object-fit: contain;
    }
    .prod-spec { font-size: 0.8rem; color: var(--text-muted); }
    .prod-desc {
      font-size: 0.82rem;
      color: var(--text-muted);
      margin-top: 0.1rem;
    }
    .prod-features {
      margin: 0.2rem 0 0;
      padding-left: 1.1rem;
      font-size: 0.8rem;
      color: var(--text-muted);
    }
    .prod-features li {
      margin-bottom: 0.15rem;
    }
    .prod-prices {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      font-size: 0.82rem;
      margin-top: 0.3rem;
    }
    .price-chip {
      border-radius: 999px;
      padding: 0.25rem 0.65rem;
      background: rgba(11,21,46,0.9);
      border: 1px solid rgba(78,109,180,0.95);
    }
    .price-chip strong { margin-left: 0.2rem; }
    .prod-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.78rem;
      color: var(--text-muted);
    }
    .prod-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
      align-items: center;
    }
    .qty-input {
      width: 70px;
      padding: 0.35rem 0.35rem;
      border-radius: 0.45rem;
      border: 1px solid rgba(87,116,178,0.9);
      background: rgba(5,10,26,0.95);
      color: var(--text-main);
      font-size: 0.8rem;
    }
    .qty-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(61,164,255,0.7);
    }
    .btn-add {
      flex: 1;
      border-radius: 0.55rem;
      border: none;
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color: #001225;
      padding: 0.45rem 0.8rem;
      font-size: 0.85rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      font-weight: 600;
    }
    .btn-add:hover { filter: brightness(1.05); }

    .about {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.3fr);
      gap: 2rem;
      align-items: center;
      padding: 1.5rem;
      border-radius: 1.25rem;
      background: linear-gradient(130deg, rgba(17,33,70,0.98), #050814);
      border: 1px solid rgba(69,101,177,0.9);
      box-shadow: 0 24px 60px rgba(0,0,0,0.85);
    }
    .about p {
      font-size: 0.9rem;
      color: var(--text-muted);
    }
    .about-list {
      margin-top: 0.6rem;
      padding-left: 1.1rem;
      font-size: 0.84rem;
      color: var(--text-muted);
    }
    .about-list li { margin-bottom: 0.2rem; }

    .why-strip {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1rem;
      margin-top: 1.1rem;
    }
    .why-card {
      padding: 0.8rem 0.9rem;
      border-radius: 0.9rem;
      background: rgba(8,16,40,0.97);
      border: 1px solid rgba(56,84,152,0.95);
      font-size: 0.82rem;
      color: var(--text-muted);
    }
    .why-card h3 {
      font-size: 0.9rem;
      margin: 0 0 0.25rem;
    }

    .delivery {
      padding: 1.5rem 1.3rem;
      border-radius: 1.2rem;
      background: radial-gradient(circle at 0 0, rgba(64,148,255,0.18), transparent 60%),
                  rgba(8,16,40,0.97);
      border: 1px solid rgba(63,95,170,0.95);
      box-shadow: 0 22px 60px rgba(0,0,0,0.85);
    }
    .delivery h2 {
      margin-top: 0;
      margin-bottom: 0.4rem;
    }
    .delivery-body {
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-bottom: 0.75rem;
    }
    .delivery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.5rem;
      font-size: 0.85rem;
    }
    .delivery-pill {
      padding: 0.35rem 0.7rem;
      border-radius: 999px;
      background: rgba(5,12,32,0.98);
      border: 1px solid rgba(74,110,187,0.95);
      color: var(--text-muted);
    }
    .delivery-extra {
      margin-top: 0.9rem;
      font-size: 0.86rem;
      color: var(--text-muted);
    }
    .delivery-extra strong {
      color: var(--accent);
    }

    .contact-layout {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.4fr);
      gap: 1.6rem;
      align-items: flex-start;
    }
    .contact-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.2rem;
    }
    .contact-card {
      border-radius: 0.9rem;
      padding: 0.9rem 1rem;
      background: rgba(10,17,39,0.97);
      border: 1px solid rgba(63,87,145,0.95);
      font-size: 0.86rem;
      color: var(--text-muted);
    }
    .contact-card strong {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--text-main);
      display: block;
      margin-bottom: 0.3rem;
    }
    .contact-card a { color: var(--accent); }

    .quote-card {
      border-radius: 1rem;
      padding: 1rem 1.2rem 1.1rem;
      background: rgba(8,16,40,0.97);
      border: 1px solid rgba(74,110,187,0.95);
      box-shadow: 0 18px 50px rgba(0,0,0,0.85);
      font-size: 0.86rem;
    }
    .quote-card h3 {
      margin: 0 0 0.3rem;
      font-size: 1.1rem;
    }
    .quote-card p {
      margin: 0 0 0.6rem;
      color: var(--text-muted);
    }
    .quote-form {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.6rem 0.9rem;
      margin-top: 0.4rem;
      font-size: 0.84rem;
    }
    .quote-form .full {
      grid-column: 1 / -1;
    }
    .quote-label {
      display: block;
      margin-bottom: 0.18rem;
      color: var(--text-muted);
    }
    .quote-input,
    .quote-select,
    .quote-textarea {
      width: 100%;
      border-radius: 0.5rem;
      border: 1px solid rgba(78,108,176,0.95);
      background: rgba(5,10,26,0.96);
      color: var(--text-main);
      padding: 0.4rem 0.55rem;
      font-size: 0.86rem;
    }
    .quote-textarea {
      min-height: 80px;
      resize: vertical;
    }
    .quote-input:focus,
    .quote-select:focus,
    .quote-textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(61,164,255,0.7);
    }
    .quote-helper {
      margin-top: 0.55rem;
      font-size: 0.8rem;
      color: var(--text-muted);
    }
    .quote-helper a {
      color: var(--accent);
      text-decoration: none;
    }
    .quote-helper a:hover {
      text-decoration: underline;
    }
    .quote-submit {
      margin-top: 0.6rem;
      border-radius: 999px;
      border: none;
      padding: 0.55rem 1.2rem;
      font-size: 0.9rem;
      font-weight: 600;
      background: linear-gradient(130deg, var(--accent), var(--accent-strong));
      color: #001225;
      cursor: pointer;
    }

    footer {
      border-top: 1px solid rgba(40,57,102,0.9);
      padding: 1rem 1.25rem 1.5rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      text-align: center;
      background: #050814;
    }

    .cart-panel {
      position: fixed;
      right: 0;
      top: 0;
      bottom: 0;
      width: min(360px, 100%);
      background: #050814;
      border-left: 1px solid rgba(63,87,145,0.95);
      box-shadow: -24px 0 80px rgba(0,0,0,0.9);
      transform: translateX(100%);
      transition: transform 0.25s ease-out;
      z-index: 40;
      display: flex;
      flex-direction: column;
    }
    .cart-panel.open { transform: translateX(0); }
    .cart-header {
      padding: 0.9rem 1rem;
      border-bottom: 1px solid rgba(45,61,102,0.95);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
    }
    .cart-close {
      border-radius: 999px;
      width: 28px;
      height: 28px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: 1px solid rgba(84,112,173,0.95);
      background: rgba(10,18,40,0.96);
      color: var(--text-muted);
      cursor: pointer;
      font-size: 1rem;
    }
    .cart-body {
      padding: 0.75rem 1rem 1rem;
      overflow-y: auto;
      flex: 1;
      font-size: 0.85rem;
    }
    .cart-empty {
      margin-top: 1rem;
      color: var(--text-muted);
      font-size: 0.85rem;
    }
    .cart-item {
      border-radius: 0.65rem;
      padding: 0.55rem 0.55rem 0.6rem;
      border: 1px solid rgba(63,87,145,0.95);
      background: rgba(8,16,40,0.97);
      margin-bottom: 0.5rem;
    }
    .cart-item-header {
      display: flex;
      justify-content: space-between;
      gap: 0.5rem;
    }
    .cart-footer {
      border-top: 1px solid rgba(45,61,102,0.95);
      padding: 0.75rem 1rem 1rem;
      font-size: 0.85rem;
      background: #050814;
    }
    .cart-summary-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      column-gap: 0.75rem;
      margin-bottom: 0.25rem;
    }
    .cart-summary-row.total { font-weight: 600; }
    .cart-summary-note {
      margin-top: 0.35rem;
      font-size: 0.78rem;
      color: var(--text-muted);
    }
    .cart-summary-note strong {
      color: var(--accent);
    }
    .cart-checkout-btn {
      margin-top: 0.6rem;
      width: 100%;
      border-radius: 0.75rem;
      border: none;
      padding: 0.6rem 0.9rem;
      font-size: 0.9rem;
      font-weight: 600;
      background: linear-gradient(130deg, var(--accent), var(--accent-strong));
      color: #001225;
      cursor: pointer;
    }

    .toast {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      padding: 0.55rem 0.9rem;
      border-radius: 999px;
      background: rgba(4,16,36,0.98);
      border: 1px solid rgba(76,126,206,0.95);
      font-size: 0.8rem;
      color: var(--text-muted);
      opacity: 0;
      transform: translateY(20px);
      pointer-events: none;
      transition: opacity 0.18s ease-out, transform 0.18s ease-out;
      z-index: 45;
    }
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    @media (max-width: 980px) {
      .factory-hero {
        grid-template-columns: minmax(0, 1fr);
      }
      .contact-layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 820px) {
      .hero {
        grid-template-columns: minmax(0, 1fr);
        text-align: left;
      }
      .hero-visual { order: -1; }
      .hero-orbit {
        width: 220px;
        height: 220px;
      }
      .nav-links { display: none; }
    }
    @media (max-width: 480px) {
      main { padding-inline: 0.9rem; }
      .hero { padding: 1.1rem 1rem 1.7rem; }
      .product-card { padding: 0.85rem; }
    }
  
    .pricing-note {
      margin-top: 0.6rem;
      font-size: 0.82rem;
      color: var(--text-muted);
      padding: 0.55rem 0.8rem;
      border-radius: 0.75rem;
      background: rgba(7,14,36,0.98);
      border: 1px dashed rgba(87,138,226,0.9);
    }
    .pricing-note strong {
      color: var(--accent);
    }
    
    .qty-note {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-right: 0.15rem;
    }
    
    .nav-dropdown {
      position: relative;
      display: flex;
      align-items: center;
    }
    .nav-dropdown-toggle {
      background: none;
      border: none;
      color: var(--text-muted);
      font: inherit;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      gap: 0.2rem;
    }
    .nav-dropdown-toggle:hover {
      color: var(--text-main);
    }
    .nav-dropdown-menu {
      position: absolute;
      top: 150%;
      left: 0;
      background: rgba(5,9,20,0.98);
      border-radius: 0.75rem;
      padding: 0.4rem 0.35rem;
      box-shadow: 0 18px 40px rgba(0,0,0,0.55);
      display: none;
      flex-direction: column;
      min-width: 180px;
      z-index: 40;
      border: 1px solid rgba(65,98,160,0.7);
    }
    .nav-dropdown-menu.open {
      display: flex;
    }
    .nav-dropdown-item {
      background: none;
      border: none;
      color: var(--text-muted);
      text-align: left;
      padding: 0.35rem 0.75rem;
      border-radius: 0.55rem;
      font-size: 0.85rem;
      cursor: pointer;
      white-space: nowrap;
    }
    .nav-dropdown-item:hover {
      background: var(--accent-soft);
      color: var(--text-main);
    }

    .prod-main {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
    }
    .prod-main .prod-prices {
      margin-top: auto;
    }

    .delivery-list {
      margin: 1rem 0 1.5rem 0;
      padding-left: 1.2rem;
      font-size: 0.95rem;
      color: var(--text-muted);
      max-width: 720px;
    }
    .delivery-list li {
      margin-bottom: 0.4rem;
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .user-menu {
      position: relative;
      display: none;
      align-items: center;
    }
    .user-menu-toggle {
      background: none;
      border: 1px solid rgba(74,94,140,0.9);
      border-radius: 999px;
      padding: 0.3rem 0.75rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      background: rgba(3,7,20,0.9);
    }
    .user-menu-toggle:hover {
      color: var(--text-main);
      border-color: var(--accent);
    }
    .user-menu-dropdown {
      position: absolute;
      top: 130%;
      right: 0;
      background: rgba(5,9,20,0.98);
      border-radius: 0.75rem;
      padding: 0.35rem 0.35rem;
      box-shadow: 0 18px 40px rgba(0,0,0,0.55);
      display: none;
      flex-direction: column;
      min-width: 180px;
      z-index: 50;
      border: 1px solid rgba(65,98,160,0.7);
    }
    .user-menu-dropdown.open {
      display: flex;
    }
    .user-menu-item {
      background: none;
      border: none;
      color: var(--text-muted);
      text-align: left;
      padding: 0.35rem 0.75rem;
      border-radius: 0.55rem;
      font-size: 0.85rem;
      cursor: pointer;
      white-space: nowrap;
      width: 100%;
    }
    .user-menu-item:hover {
      background: var(--accent-soft);
      color: var(--text-main);
    }
    .user-greeting {
      font-size: 0.8rem;
      color: var(--text-muted);
      white-space: nowrap;
      min-width: 0;
    }
    .user-greeting span {
      color: var(--accent);
      font-weight: 500;
    }
    .signin-section {
      padding: 3rem 0 3.5rem 0;
    }
    .auth-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 1.75rem;
    }
    .auth-card {
      background: rgba(7, 14, 36, 0.97);
      border-radius: 1.2rem;
      padding: 1.5rem 1.6rem;
      border: 1px solid rgba(65, 98, 160, 0.85);
      box-shadow: 0 18px 50px rgba(0,0,0,0.75);
      font-size: 0.86rem;
      color: var(--text-muted);
    }
    .auth-card h3 {
      margin: 0 0 0.35rem;
      font-size: 1.05rem;
      color: var(--text-main);
    }
    .auth-intro {
      margin: 0 0 0.7rem;
      font-size: 0.86rem;
      color: var(--text-muted);
    }
    .auth-form {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.6rem 0.9rem;
    }
    .auth-form .full-row {
      grid-column: 1 / -1;
    }
    .auth-label {
      display: block;
      margin-bottom: 0.2rem;
      font-size: 0.8rem;
      color: var(--text-muted);
    }
    .auth-input,
    .auth-select {
      width: 100%;
      border-radius: 0.55rem;
      border: 1px solid rgba(78, 108, 176, 0.95);
      background: rgba(5, 10, 26, 0.96);
      color: var(--text-main);
      padding: 0.4rem 0.55rem;
      font-size: 0.85rem;
    }
    .auth-input:focus,
    .auth-select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(61,164,255,0.7);
    }
    .auth-check {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.8rem;
      margin-top: 0.4rem;
    }
    .auth-check input {
      width: auto;
      margin: 0;
    }
    .auth-actions {
      margin-top: 0.7rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.6rem;
      align-items: center;
    }
    .auth-submit {
      border-radius: 999px;
      border: none;
      padding: 0.55rem 1.2rem;
      font-size: 0.88rem;
      font-weight: 600;
      background: linear-gradient(130deg, var(--accent), var(--accent-strong));
      color: #001225;
      cursor: pointer;
    }
    .auth-note {
      font-size: 0.78rem;
      color: var(--text-muted);
    }
    .auth-footnote {
      margin-top: 0.6rem;
      font-size: 0.78rem;
      color: var(--text-muted);
    }
    .auth-footnote strong {
      color: var(--accent);
    }
    @media (max-width: 900px) {
      .auth-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }
    .cart-summary-row select#cart-payment {
      font-size: 0.8rem;
      padding: 0.25rem 0.4rem;
      border-radius: 0.5rem;
      border: 1px solid rgba(74,94,140,0.9);
      background: rgba(3,7,20,0.9);
      color: var(--text-main);
    }

.signin-section > * {
  max-width:1100px;
  margin-left:auto;
  margin-right:auto;
  padding-left:1.5rem;
  padding-right:1.5rem;
}

/* ADMIN PAGE */
.admin-section {
  margin-top: 2.5rem;
}

.admin-customers-grid {
  margin-top: 1.2rem;
  display: grid;
  grid-template-columns: minmax(0, 1fr);
  gap: 1rem;
}

.admin-customer-card {
  border-radius: 0.9rem;
  background: rgba(8,16,40,0.95);
  border: 1px solid rgba(60,95,170,0.9);
  padding: 0.9rem;
  box-shadow: 0 16px 40px rgba(0,0,0,0.8);
  font-size: 0.85rem;
}

.admin-customer-header {
  display: flex;
  flex-direction: column;
  gap: 0.1rem;
  margin-bottom: 0.6rem;
}

.admin-customer-name {
  font-weight: 600;
}

.admin-customer-email {
  color: var(--text-muted);
  font-size: 0.8rem;
}

.admin-customer-fields {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 0.6rem;
  margin-bottom: 0.7rem;
}

.admin-customer-fields label {
  display: flex;
  flex-direction: column;
  gap: 0.15rem;
  font-size: 0.8rem;
  color: var(--text-muted);
}

.admin-customer-fields select,
.admin-customer-fields input {
  font-size: 0.82rem;
  padding: 0.25rem 0.4rem;
  border-radius: 0.5rem;
  border: 1px solid rgba(74,94,140,0.9);
  background: rgba(3,7,20,0.9);
  color: var(--text-main);
}

.admin-customer-card .admin-save-btn {
  margin-top: 0.3rem;
  font-size: 0.8rem;
  padding: 0.4rem 0.9rem;
}

.admin-customer-platinum {
  margin-top: 0.8rem;
  border-top: 1px solid rgba(60,95,170,0.9);
  padding-top: 0.7rem;
}

.admin-customer-platinum h2,
.admin-customer-platinum h4 {
  margin: 0 0 0.5rem;
  font-size: 0.9rem;
}

.admin-prices-grid {
  display: grid;
  grid-template-columns: minmax(0, 1fr);
  gap: 0.35rem;
  max-height: 260px;
  overflow-y: auto;
}

.admin-price-row {
  display: grid;
  grid-template-columns: 2fr 1.1fr 1.1fr;
  gap: 0.4rem;
  align-items: center;
  font-size: 0.8rem;
}

.admin-price-row .apr-name {
  font-size: 0.8rem;
}

.admin-price-row .apr-field label {
  display: flex;
  flex-direction: column;
  gap: 0.1rem;
}

.admin-price-row input {
  font-size: 0.8rem;
  padding: 0.18rem 0.32rem;
  border-radius: 0.4rem;
  border: 1px solid rgba(74,94,140,0.9);
  background: rgba(3,7,20,0.95);
  color: var(--text-main);
}


    @page {
      size: A4;
      margin: 12mm;
    }

    @media print {

    body {
        background: url('shrinxa_transparent_4000px.png') center center no-repeat !important;
        background-size: 60% auto !important;
        opacity: 1 !important;
    }
    
  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
  html, body {
    background: #ffffff !important;
    margin: 0 !important;
    padding: 0 !important;
    height: auto !important;
  }
  body * {
    display: none !important;
  }
  #invoiceModal,
  #invoiceModal * {
    display: unset !important;
    visibility: visible !important;
  }
  #invoiceModal {
    display: block !important;
    position: static !important;
    inset: auto !important;
    background: #ffffff !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 !important;
  }
  #invoiceModal .modal-card {
    box-shadow: none !important;
    border: none !important;
    max-width: 720px !important;
    width: 100% !important;
    margin: 0 auto !important;
    max-height: none !important;
    overflow: visible !important;
  }
  #invoiceModal .invoice-actions,
  #invoiceClose,
  #invoicePrint,
  #invoiceDownload {
    display: none !important;
  }
  @page {
    size: A4;
    margin: 12mm;
  }
}</style>
</head>
<body>
<header>
<div class="nav-inner">
<div class="nav-left">
<div class="nav-logo">
<img alt="Shrinxa logo" src="shrinxa_transparent_4000px.png"/>
</div>
<div class="nav-brand-text">
<strong>SHRINXA</strong>
<span>Premium Packaging Solutions</span>
</div>
</div>
<nav class="nav-links">
<a class="nav-anchor nav-home" data-nav="home" href="login.html">Home</a>
<div class="nav-dropdown">
<button class="nav-anchor nav-dropdown-toggle" data-nav="products" type="button">Products â–¾</button>
<div class="nav-dropdown-menu">
<button class="nav-dropdown-item" data-filter="all" type="button">All products</button>
<button class="nav-dropdown-item" data-filter="Stretch Wrap" type="button">Stretch Wrap</button>
<button class="nav-dropdown-item" data-filter="Pre-Stretch Wrap" type="button">Pre-Stretch Wrap</button>
<button class="nav-dropdown-item" data-filter="Packaging Tape" type="button">Tape rolls</button>
</div>
</div>
<a class="nav-anchor nav-about" data-nav="about" href="#about">About</a>
<a class="nav-anchor nav-delivery" data-nav="delivery" href="#delivery">Delivery</a>
<a class="nav-anchor nav-contact" data-nav="contact" href="#contact">Contact us</a>
<a class="nav-anchor nav-admin" data-nav="admin" href="#admin" style="display:none;">Admin</a>
<a class="nav-anchor nav-signin" data-nav="signin" href="login.html">Sign in</a></nav>
<div class="nav-right"><div class="user-menu" id="user-menu" style="display:none; position:relative;"><button class="user-menu-toggle" id="userMenuToggle" type="button"><span id="userMenuName">Profile</span> â–¾</button><div class="user-menu-dropdown" id="userMenuDropdown"><button class="user-menu-item" type="button" data-action="profile">Profile</button><button class="user-menu-item" type="button" data-action="history">Purchase History</button><button class="user-menu-item" type="button" data-action="signout">Sign out</button></div></div><div class="user-greeting" id="user-greeting"></div><button class="cart-chip" id="openCartBtn">
      ðŸ§º Cart <span class="badge" id="cartCount">0</span>
</button></div></div>
</header>
<main>
<!-- HERO -->
<section class="hero page-section" data-page="home" id="top">
<div>
<div class="hero-kicker">Industrial-grade stretch wrap &amp; tape</div>
<h1>Wrap smart. <span class="accent">Ship with Shrinxa.</span></h1>
<p class="lede">
        Canadian packaging supplier providing premium stretch films, pre-stretch wrap, and adhesive
        tape rolls for warehouses, 3PLs, logistics hubs and e-commerce operations across Canada.
        Free delivery on orders over $300 within our service area.
      </p>
<div class="hero-cta">
<button class="btn-primary" onclick="setView('products'); applyFilter('all');">
          Browse product catalogue â†“
        </button>
<button class="btn-ghost" onclick="setView('about');">
          Learn about Shrinxa
        </button>
<button class="btn-ghost" onclick="setView('contact');">Get a Quote</button></div>
<div class="hero-meta">
<span>Fast GTA delivery</span>
<span>Wholesale-ready pricing</span>
<span>13% HST applied on all orders</span>
</div>
</div>
<div class="hero-visual">
<div class="hero-orbit">
<img alt="Shrinxa logo decorative" src="shrinxa_transparent_4000px.png"/>
</div>
</div>
</section>
<!-- FACTORY IMAGE BLOCK -->
<section class="factory-hero page-section" data-page="home">
<div class="factory-image-wrap">
<!-- Replace this file with your real 4K factory photo -->
<img alt="Shrink wrap production line with pallets ready for shipping" src="factory-hero-4k.jpg"/>
</div>
<div class="factory-copy">
<h2>Built for busy warehouses and production floors</h2>
<p>
        High-clarity stretch film, pre-stretch wrap and tape rolls designed to keep pallets
        secure from the end of your line to the customerâ€™s dock door.
      </p>
<div class="factory-points">
<div>Crystal-clear film for easy barcode and label scanning.</div>
<div>Reliable containment on mixed-height and high-value pallets.</div>
<div>Roll lengths optimized to reduce changeovers and downtime.</div>
<div>Perfect fit for 3PLs, distributors, manufacturers and e-commerce hubs.</div>
</div>
</div>
</section>
<!-- ABOUT -->
<section class="page-section" data-page="about" id="about">
<h2>About Shrinxa</h2>
<p class="section-lede">
      Shrinxa focuses on one thing: helping warehouses secure every pallet with less waste,
      less headache, and more consistency.
    </p>
<div class="about">
<div>
<p>
          From stretch films to pre-stretch and premium tape rolls, our catalogue is designed
          around real-world Canadian warehouse conditionsâ€”cold docks, long hauls, and busy
          pick/pack operations. Every product is carefully selected for strength, clarity and
          ease of use at the pallet wrapper or by hand.
        </p><p>Shrinxa is a family-owned Canadian business based in the Greater Toronto Area, focused entirely on pallet packaging instead of general office supplies.</p>
<p>
          Instead of carrying hundreds of confusing SKUs, Shrinxa focuses on a compact, high-performing
          range of products that are easy to understand and easy to reorder. That means your team can
          quickly learn which film or tape fits which jobâ€”and you can standardize across locations
          without sacrificing performance.
        </p>
<p>
          Whether you are a growing e-commerce operation or an established 3PL, our goal is to help
          you reduce film usage per pallet, avoid damaged shipments, and get predictable, repeatable
          results from every roll you open.
        </p>
<ul class="about-list">
<li>Hand wrap and pre-stretch options for different load profiles.</li>
<li>Gauge and micron combinations tuned for cost-per-pallet efficiency.</li>
<li>Water-based and hot-melt tapes for standard and recycled cartons.</li>
<li>Wholesale pricing structure ideal for 3PLs, distributors and multi-site accounts.</li>
<li>Free delivery on orders over $300 within our service area.</li>
</ul>
</div>
<div>
<div class="why-strip">
<div class="why-card">
<h3>Warehouse ready</h3>
<p>Films and tapes that perform on the floor: tight wraps, strong seals and clean release.</p>
</div>
<div class="why-card">
<h3>Cost focused</h3>
<p>Longer rolls, smart gauges and pre-stretch technology help reduce film usage per pallet.</p>
</div>
<div class="why-card">
<h3>Easy to order</h3>
<p>Use this website to build a cart, copy the summary and request your quote in minutes.</p>
</div>
</div>
</div>
</div>
</section>
<!-- PRODUCTS -->
<section class="page-section" data-page="products" id="products">
<h2>Product catalogue</h2>
<p class="section-lede">All items below come directly from the official Shrinxa catalogue. Use the filters to see only Stretch Wrap, Pre-Stretch, or Tape rolls. The cart is a simulator and applies 13% HST on the subtotal.</p><div class="pricing-note">Pricing tiers: retail applies from 1â€“49 boxes per item. Wholesale pricing starts from 50 boxes and above for a given product line. Orders under $300 are estimated at a $30 GTA delivery charge; orders $300+ qualify for free delivery.</div>
<div class="filters-row">
<button class="pill" data-filter="all">All products</button>
<button class="pill" data-filter="Stretch Wrap">Stretch Wrap</button>
<button class="pill" data-filter="Pre-Stretch Wrap">Pre-Stretch Wrap</button>
<button class="pill" data-filter="Packaging Tape">Tape rolls</button>
</div>
<div class="products-grid">
<!-- STRETCH WRAP -->
<article class="product-card" data-id="fortress-12" data-name='Fortress Mid-Wrap (12")' data-retail="48" data-retail-gold="45" data-type="Stretch Wrap" data-wholesale="40" data-wholesale-gold="40">
<div class="prod-header">
<div class="prod-name">Fortress Mid-Wrap (12")</div>
<div class="prod-category">Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="Fortress Mid-Wrap 12 inch stretch film" src="fortress-12.png"/>
</div>
<div class="prod-main"><div class="prod-spec">12" Â· Gauge 80 Â· 450M Â· 4 rolls/box</div><p class="prod-desc">
          Durable, high-strength hand film for everyday palletizing. Delivers reliable puncture
          resistance and tight load containment for medium-to-heavy loads where control and
          precision wrapping are important.
        </p><ul class="prod-features">
<li>Medium-width roll ideal for narrower or irregular pallets.</li>
<li>Gauge 80 strength for confident containment of mixed loads.</li>
<li>Smooth unwind for faster wrapping with less operator fatigue.</li>
<li>High-clarity film keeps labels and barcodes visible.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$48.00</strong></span>
<span class="price-chip">Wholesale <strong>$40.00</strong></span>
</div><div class="prod-meta">
<span>4 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="titan-14" data-name='Titan Heavy-Wrap (14")' data-retail="55" data-retail-gold="50" data-type="Stretch Wrap" data-wholesale="47" data-wholesale-gold="43">
<div class="prod-header">
<div class="prod-name">Titan Heavy-Wrap (14")</div>
<div class="prod-category">Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="Titan Heavy-Wrap 14 inch stretch film" src="titan-14.png"/>
</div>
<div class="prod-main"><div class="prod-spec">14" Â· Gauge 90 Â· 450M Â· 4 rolls/box</div><p class="prod-desc">
          Heavy-duty stretch film engineered for demanding loads. Extra gauge thickness and wider
          web provide aggressive containment for bulky, uneven, or high-density pallets.
        </p><ul class="prod-features">
<li>Gauge 90 for higher puncture and tear resistance.</li>
<li>14" width gives more coverage with each pass around the pallet.</li>
<li>Helps stabilize tall or top-heavy pallets during transit.</li>
<li>Ideal for construction materials, hardware and dense cartons.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$55.00</strong></span>
<span class="price-chip">Wholesale <strong>$47.00</strong></span>
</div><div class="prod-meta">
<span>4 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="steadfast-18" data-name='Steadfast All-Purpose (18")' data-retail="70" data-retail-gold="60" data-type="Stretch Wrap" data-wholesale="62" data-wholesale-gold="53">
<div class="prod-header">
<div class="prod-name">Steadfast All-Purpose (18")</div>
<div class="prod-category">Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="Steadfast All-Purpose 18 inch stretch film" src="steadfast-18.png"/>
</div>
<div class="prod-main"><div class="prod-spec">18" Â· Gauge 80 Â· 450M Â· 4 rolls/box</div><p class="prod-desc">
          A versatile, all-purpose 18" hand film that balances strength and usability. Perfect for
          warehouses that wrap a wide mix of pallets and want one reliable go-to film.
        </p><ul class="prod-features">
<li>Popular 18" width for maximum coverage per revolution.</li>
<li>Gauge 80 film gives dependable performance on most pallet weights.</li>
<li>Good puncture resistance to handle corners and sharp edges.</li>
<li>Clear optics help with product identification and scanning.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$70.00</strong></span>
<span class="price-chip">Wholesale <strong>$62.00</strong></span>
</div><div class="prod-meta">
<span>4 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="colossus-20-max" data-name='Colossus Max-Load (20")' data-retail="70" data-retail-gold="60" data-type="Stretch Wrap" data-wholesale="62" data-wholesale-gold="53">
<div class="prod-header">
<div class="prod-name">Colossus Max-Load (20")</div>
<div class="prod-category">Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="Colossus Max-Load 20 inch stretch film" src="colossus-max-20.png"/>
</div>
<div class="prod-main"><div class="prod-spec">20" Â· Gauge 70 Â· 1800M Â· 1 roll/box</div><p class="prod-desc">
          Long-length stretch film for efficient wrapping of medium-duty pallets. Designed to reduce
          roll changeovers while maintaining secure, consistent load containment.
        </p><ul class="prod-features">
<li>20" width rapidly covers large pallet faces.</li>
<li>Gauge 70 for strong everyday performance with optimized material use.</li>
<li>1800M roll length lowers downtime from frequent roll changes.</li>
<li>Great fit for busy shipping departments and production lines.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$70.00</strong></span>
<span class="price-chip">Wholesale <strong>$62.00</strong></span>
</div><div class="prod-meta">
<span>1 roll per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="colossus-20-heavy" data-name='Colossus Heavy-Duty (20")' data-retail="80" data-retail-gold="70" data-type="Stretch Wrap" data-wholesale="72" data-wholesale-gold="60">
<div class="prod-header">
<div class="prod-name">Colossus Heavy-Duty (20")</div>
<div class="prod-category">Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="Colossus Heavy-Duty 20 inch stretch film" src="colossus-heavy-20.png"/>
</div>
<div class="prod-main"><div class="prod-spec">20" Â· Gauge 90 Â· 1800M Â· 1 roll/box</div><p class="prod-desc">
          A true heavy-duty 20" film for the most demanding applications. Extra-thick gauge and long
          roll length provide maximum security on heavy, sharp, or high-value pallets.
        </p><ul class="prod-features">
<li>Gauge 90 film resists punctures, tears and corner damage.</li>
<li>Excellent for metal goods, building materials and dense freight.</li>
<li>Reduces risk of load shifting on long or rough routes.</li>
<li>1800M length helps keep high-volume operations moving.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$80.00</strong></span>
<span class="price-chip">Wholesale <strong>$72.00</strong></span>
</div><div class="prod-meta">
<span>1 roll per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<!-- PRE-STRETCH -->
<article class="product-card" data-id="flexlite-12" data-name='FlexLite Mid-Stretch (12")' data-retail="38" data-retail-gold="35" data-type="Pre-Stretch Wrap" data-wholesale="30" data-wholesale-gold="28">
<div class="prod-header">
<div class="prod-name">FlexLite Mid-Stretch (12")</div>
<div class="prod-category">Pre-Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="FlexLite Mid-Stretch 12 inch pre-stretch film" src="flexlite-12.png"/>
</div>
<div class="prod-main"><div class="prod-spec">12" Â· 10 Microns Â· 450M Â· 4 rolls/box</div><p class="prod-desc">
          Lightweight, ultra-thin pre-stretch film that arrives already stretched for you. Delivers
          consistent holding force with less effort and material compared to traditional hand wrap.
        </p><ul class="prod-features">
<li>Ultra-thin 10 micron film maximizes yield per roll.</li>
<li>Pre-stretched design reduces operator fatigue and improves speed.</li>
<li>Ideal for light to medium-weight pallets and frequent hand wrapping.</li>
<li>Great upgrade when moving away from standard gauge hand films.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$38.00</strong></span>
<span class="price-chip">Wholesale <strong>$30.00</strong></span>
</div><div class="prod-meta">
<span>4 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="flexlite-14" data-name='FlexLite Reinforced (14")' data-retail="45" data-retail-gold="40" data-type="Pre-Stretch Wrap" data-wholesale="37" data-wholesale-gold="32">
<div class="prod-header">
<div class="prod-name">FlexLite Reinforced (14")</div>
<div class="prod-category">Pre-Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="FlexLite Reinforced 14 inch pre-stretch film" src="flexlite-14.png"/>
</div>
<div class="prod-main"><div class="prod-spec">14" Â· 10 Microns Â· 450M Â· 4 rolls/box</div><p class="prod-desc">
          A slightly wider pre-stretch option that provides excellent cling and containment. Designed
          to handle more challenging mixed pallets while still saving film per load.
        </p><ul class="prod-features">
<li>14" width covers more surface area in fewer wraps.</li>
<li>Pre-stretch technology keeps tension stable around the pallet.</li>
<li>Helps reduce neck-down and film breaks compared to low-quality films.</li>
<li>Ideal for 3PL and distribution environments with varied SKUs.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$45.00</strong></span>
<span class="price-chip">Wholesale <strong>$37.00</strong></span>
</div><div class="prod-meta">
<span>4 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="flexlite-18" data-name='FlexLite Pro-Stretch (18")' data-retail="60" data-retail-gold="50" data-type="Pre-Stretch Wrap" data-wholesale="52" data-wholesale-gold="43">
<div class="prod-header">
<div class="prod-name">FlexLite Pro-Stretch (18")</div>
<div class="prod-category">Pre-Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="FlexLite Pro-Stretch 18 inch pre-stretch film" src="flexlite-18.png"/>
</div>
<div class="prod-main"><div class="prod-spec">18" Â· 10 Microns Â· 450M Â· 4 rolls/box</div><p class="prod-desc">
          Professional-grade pre-stretch film for operations that want the lowest cost per pallet.
          Combines wide coverage with light, easy handling.
        </p><ul class="prod-features">
<li>18" width speeds up wrapping on standard pallet footprints.</li>
<li>Great combination of film savings and load security.</li>
<li>Ideal for shipping departments with high daily pallet counts.</li>
<li>Reduces overall film consumption compared to conventional rolls.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$60.00</strong></span>
<span class="price-chip">Wholesale <strong>$52.00</strong></span>
</div><div class="prod-meta">
<span>4 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="flexlite-20" data-name='FlexLite Max-Stretch (20")' data-retail="85" data-retail-gold="75" data-type="Pre-Stretch Wrap" data-wholesale="75" data-wholesale-gold="65">
<div class="prod-header">
<div class="prod-name">FlexLite Max-Stretch (20")</div>
<div class="prod-category">Pre-Stretch Wrap</div>
</div>
<div class="prod-image-wrap">
<img alt="FlexLite Max-Stretch 20 inch pre-stretch film" src="flexlite-20.png"/>
</div>
<div class="prod-main"><div class="prod-spec">20" Â· 10.7 Microns Â· 2700M Â· 1 roll/box</div><p class="prod-desc">
          High-yield pre-stretch film with an extra-long 2700M roll length. Built for operations that
          want to minimize changeovers and keep lines running.
        </p><ul class="prod-features">
<li>20" width quickly covers large and tall pallets.</li>
<li>10.7 micron film provides excellent yield with dependable containment.</li>
<li>2700M length drastically reduces roll changes on busy shifts.</li>
<li>Perfect for high-volume production, co-packers and 3PL facilities.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$85.00</strong></span>
<span class="price-chip">Wholesale <strong>$75.00</strong></span>
</div><div class="prod-meta">
<span>1 roll per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<!-- TAPE ROLLS -->
<article class="product-card" data-id="water-2" data-name='Water Glue Clear-Tape (2")' data-retail="65" data-retail-gold="55" data-type="Packaging Tape" data-wholesale="57" data-wholesale-gold="50">
<div class="prod-header">
<div class="prod-name">Water Glue Clear-Tape (2")</div>
<div class="prod-category">Packaging Tape</div>
</div>
<div class="prod-image-wrap">
<img alt="Water Glue Tape 2 inch" src="water-tape-2.png"/>
</div>
<div class="prod-main"><div class="prod-spec">Water glue Â· 50 Microns Â· 100M Â· 32 rolls/box</div><p class="prod-desc">
          Clear water-based adhesive tape designed for clean, tamper-evident seals on standard
          cartons. Activates with pressure for a permanent bond on corrugated surfaces.
        </p><ul class="prod-features">
<li>50 micron film for strong sealing strength on everyday boxes.</li>
<li>Excellent adhesion to virgin and recycled corrugated board.</li>
<li>2" width is ideal for standard e-commerce and shipper cartons.</li>
<li>Resists humidity and temperature swings during storage and transport.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$65.00</strong></span>
<span class="price-chip">Wholesale <strong>$57.00</strong></span>
</div><div class="prod-meta">
<span>32 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="hotmelt-2" data-name='Hot Melt Max-Grip (2")' data-retail="75" data-retail-gold="70" data-type="Packaging Tape" data-wholesale="67" data-wholesale-gold="62">
<div class="prod-header">
<div class="prod-name">Hot Melt Max-Grip (2")</div>
<div class="prod-category">Packaging Tape</div>
</div>
<div class="prod-image-wrap">
<img alt="Hot Melt Tape 2 inch" src="hotmelt-2.png"/>
</div>
<div class="prod-main"><div class="prod-spec">Hot melt Â· 50 Microns Â· 100M Â· 32 rolls/box</div><p class="prod-desc">
          Strong pressure-sensitive carton sealing tape with aggressive hot-melt adhesive. Designed
          for fast-moving packing stations and reliable sealing on a wide range of box types.
        </p><ul class="prod-features">
<li>High-tack hot-melt adhesive grabs quickly and holds firmly.</li>
<li>Performs well on both virgin and recycled corrugated cartons.</li>
<li>2" width works with standard tape guns and dispensers.</li>
<li>Excellent choice for general shipping, fulfillment and 3PL use.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$75.00</strong></span>
<span class="price-chip">Wholesale <strong>$67.00</strong></span>
</div><div class="prod-meta">
<span>32 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="water-3" data-name='Water Glue Clear-Tape (3")' data-retail="65" data-retail-gold="55" data-type="Packaging Tape" data-wholesale="57" data-wholesale-gold="50">
<div class="prod-header">
<div class="prod-name">Water Glue Clear-Tape (3")</div>
<div class="prod-category">Packaging Tape</div>
</div>
<div class="prod-image-wrap">
<img alt="Water Glue Tape 3 inch" src="water-tape-3.png"/>
</div>
<div class="prod-main"><div class="prod-spec">Water glue Â· 50 Microns Â· 100M Â· 24 rolls/box</div><p class="prod-desc">
          Wider-format water glue tape for extra sealing security on heavy or oversized cartons.
          Creates a tamper-evident, permanent bond once applied.
        </p><ul class="prod-features">
<li>3" width provides more coverage and edge protection on big boxes.</li>
<li>Ideal for export shipments, heavy products and over-packed cartons.</li>
<li>Strong adhesion even on rough or recycled corrugated surfaces.</li>
<li>Helps prevent carton opening during vibration and long-distance transit.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$65.00</strong></span>
<span class="price-chip">Wholesale <strong>$57.00</strong></span>
</div><div class="prod-meta">
<span>24 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
<article class="product-card" data-id="hotmelt-3" data-name='Hot Melt Max-Grip (3")' data-retail="75" data-retail-gold="70" data-type="Packaging Tape" data-wholesale="67" data-wholesale-gold="62">
<div class="prod-header">
<div class="prod-name">Hot Melt Max-Grip (3")</div>
<div class="prod-category">Packaging Tape</div>
</div>
<div class="prod-image-wrap">
<img alt="Hot Melt Tape 3 inch" src="hotmelt-3.png"/>
</div>
<div class="prod-main"><div class="prod-spec">Hot melt Â· 50 Microns Â· 100M Â· 24 rolls/box</div><p class="prod-desc">
          Extra-wide hot-melt sealing tape offering powerful grip and coverage. Made for heavy
          cartons, unstable loads and shipments where box integrity is critical.
        </p><ul class="prod-features">
<li>3" width improves seal strength across major carton seams.</li>
<li>Hot-melt adhesive delivers a strong, reliable bond in seconds.</li>
<li>Performs well under vibration, stacking and long-term storage.</li>
<li>Great option for industrial, manufacturing and export customers.</li>
</ul><div class="prod-prices">
<span class="price-chip">Retail <strong>$75.00</strong></span>
<span class="price-chip">Wholesale <strong>$67.00</strong></span>
</div><div class="prod-meta">
<span>24 rolls per box</span>
<span>Cart uses tiered pricing (retail 1â€“49 boxes, wholesale 50+)</span>
</div></div>
<div class="prod-actions">
<span class="qty-note">Qty (boxes)</span><input class="qty-input" min="1" type="number" value="1"/>
<button class="btn-add">Add to cart</button>
</div>
</article>
</div>
</section>
<!-- DELIVERY & SERVICE AREA -->
<section class="page-section" data-page="delivery" id="delivery">
<div class="delivery">
<h2>Delivery &amp; Service Area</h2>
<p class="delivery-body">We operate dedicated delivery routes across the GTA so your pallet wrap and tape arrive when your warehouse team needs them. Most orders ship from local inventory and are delivered direct to your dock doors on predictable schedules.</p><ul class="delivery-list"><li>Nextâ€‘day delivery available on most inâ€‘stock items within our core GTA zones.</li><li>Directâ€‘toâ€‘dock service for warehouses, 3PLs, production facilities and distribution centres.</li><li>Flexible time windows for busy yards, including morning dropâ€‘offs before outbound trailers load.</li><li>Options for recurring standing orders so film and tape arrive on the same days every week.</li><li>Careful handling of palletized loads to keep shrink wrap rolls clean, dry and ready for use.</li></ul>
<div class="delivery-grid">
<div class="delivery-pill">Mississauga</div>
<div class="delivery-pill">Oakville</div>
<div class="delivery-pill">Brampton</div>
<div class="delivery-pill">Etobicoke</div>
<div class="delivery-pill">North York</div>
<div class="delivery-pill">Scarborough</div>
<div class="delivery-pill">Vaughan &amp; Concord</div>
<div class="delivery-pill">Woodbridge</div>
<div class="delivery-pill">Markham &amp; Richmond Hill</div>
<div class="delivery-pill">Burlington</div></div>
<p class="delivery-extra">For large or recurring orders, we can discuss regular delivery schedules tailored to your
        operation. Delivery is free on orders over $300 within our service area. Typical lead time: 1â€“3 business days for GTA deliveries.</p>
</div>
</section>
<!-- CONTACT + GET A QUOTE -->
<section class="page-section" data-page="contact" id="contact">
<h2>Contact &amp; Quote</h2>
<p class="section-lede">
      Use this simulator to estimate orders, then email us your cart summary or send a quote request
      using the form below. All items are subject to 13% HST.
    </p>
<div class="contact-layout">
<div class="contact-grid">
<div class="contact-card">
<strong>Website</strong>
<div><a href="https://www.shrinxa.com" rel="noreferrer" target="_blank">www.shrinxa.com</a></div>
</div>
<div class="contact-card">
<strong>Email</strong>
<div><div>For quotes: <a href="mailto:sales@shrinxa.com">sales@shrinxa.com</a></div><div>General questions: <a href="mailto:info@shrinxa.com">info@shrinxa.com</a></div></div>
</div>
<div class="contact-card">
<strong>Phone</strong>
<div>+1 (613) 640-5302</div>
</div>
<div class="contact-card">
<strong>Location</strong>
<div>Greater Toronto Area, Canada</div>
</div>
</div>
<div class="quote-card">
<h3>Get a Quote</h3>
<p>
          Tell us what you use today, and weâ€™ll help you find the best Shrinxa optionâ€”often at a better price.
        </p>
<form class="quote-form">
<div>
<label class="quote-label" for="q-name">Full Name</label>
<input class="quote-input" id="q-name" name="full_name" placeholder="John Doe" type="text"/>
</div>
<div>
<label class="quote-label" for="q-company">Company Name</label>
<input class="quote-input" id="q-company" name="company_name" placeholder="Warehouse / 3PL / Business name" type="text"/>
</div>
<div>
<label class="quote-label" for="q-email">Email</label>
<input class="quote-input" id="q-email" name="email" placeholder="you@example.com" type="email"/>
</div>
<div>
<label class="quote-label" for="q-phone">Phone Number (optional)</label>
<input class="quote-input" id="q-phone" name="phone" placeholder="+1 (___) ___-____" type="tel"/>
</div>
<div>
<label class="quote-label" for="q-address">Address</label>
<input class="quote-input" id="q-address" name="address" placeholder="Street address, unit, etc." type="text"/>
</div>
<div>
<label class="quote-label" for="q-postal">Postal Code (optional)</label>
<input class="quote-input" id="q-postal" name="postal" placeholder="A1A 1A1" type="text"/>
</div>
<div>
<label class="quote-label" for="q-products">Products of interest</label>
<select class="quote-select" id="q-products" name="products">
<option value="">Select one or more (describe in message)</option>
<option value="shrink-wrap">Shrink Wrap</option>
<option value="pre-stretch">Pre-Stretch</option>
<option value="hot-melt-tape">Hot Melt Tape</option>
<option value="water-activated-tape">Water-Activated Tape</option>
<option value="other">Other</option>
</select>
</div>
<div>
<label class="quote-label" for="q-usage">Approximate monthly usage</label>
<select class="quote-select" id="q-usage" name="usage">
<option value="">Select an option</option>
<option value="1-10">1â€“10 boxes</option>
<option value="10-50">10â€“50 boxes</option>
<option value="50-100">50â€“100 boxes</option>
<option value="100-plus">100+ boxes</option>
</select>
</div>
<div class="full">
<label class="quote-label" for="q-message">Message</label>
<textarea class="quote-textarea" id="q-message" name="message" placeholder="Tell us about your current film or tape, pallet types, and any issues youâ€™d like to solve (breakage, shifting, too much film, etc.)."></textarea>
</div>
<div class="full">
<button class="quote-submit" onclick="alert('This is a demo form. Connect it to your email or CRM when you go live.')" type="button">
              Submit quote request
            </button>
</div>
</form>
<div class="quote-helper">Prefer to talk directly? For quotes email sales@shrinxa.com. For general questions email info@shrinxa.com.</div>
</div>
</div>
</section>

<section class="page-section" data-page="profile" id="profile">
  <h2>Your Profile</h2>
  <p class="section-lede">
    View and update your account details. 
  </p>
  <div class="about" style="grid-template-columns:minmax(0,1.6fr) minmax(0,1.2fr);">
    <div>
      <form class="auth-form" id="profile-form" style="grid-template-columns:repeat(2,minmax(0,1fr));gap:0.6rem 0.9rem;">
        <div class="full-row">
          <label class="auth-label" for="profile-name">Full Name</label>
          <input class="auth-input" id="profile-name" type="text" />
        </div>
        <div>
          <label class="auth-label" for="profile-company">Company Name</label>
          <input class="auth-input" id="profile-company" type="text" />
        </div>
        <div>
          <label class="auth-label" for="profile-type">Business type</label>
          <select class="auth-select" id="profile-type">
            <option value="warehouse">Warehouse / Distribution</option>
            <option value="3pl">3PL / Fulfillment</option>
            <option value="manufacturer">Manufacturer</option>
            <option value="ecom">E-commerce brand</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div>
          <label class="auth-label" for="profile-email">Email</label>
          <input class="auth-input" id="profile-email" type="email" disabled />
        </div>
        <div>
          <label class="auth-label" for="profile-phone">Phone Number</label>
          <input class="auth-input" id="profile-phone" type="tel" />
        </div>
        <div class="full-row">
          <label class="auth-label" for="profile-address">Address</label>
          <input class="auth-input" id="profile-address" type="text" />
        </div>
        <div>
          <label class="auth-label" for="profile-postal">Postal Code</label>
          <input class="auth-input" id="profile-postal" type="text" />
        </div>
        <div>
          <label class="auth-label" for="profile-tier">Pricing Tier</label>
          <input class="auth-input" id="profile-tier" type="text" disabled />
        </div>
        <div class="full-row" style="margin-top:0.2rem;">
          <button type="submit" class="auth-submit">Save profile</button>
        </div>
      </form>
    </div>
    <div>
      <h3 style="margin-top:0;margin-bottom:0.4rem;font-size:1rem;">Change password</h3>
      <p class="auth-intro" style="margin-bottom:0.6rem;">
        To change your password, enter your current password and choose a new one.
      </p>
      <form id="password-form" class="auth-form" style="grid-template-columns:minmax(0,1fr);">
        <div class="full-row">
          <label class="auth-label" for="profile-current-password">Current password</label>
          <input class="auth-input" id="profile-current-password" type="password" placeholder="Current password" />
        </div>
        <div class="full-row">
          <label class="auth-label" for="profile-new-password">New password</label>
          <input class="auth-input" id="profile-new-password" type="password" placeholder="New password" />
        </div>
        <div class="full-row">
          <label class="auth-label" for="profile-new-password2">Confirm new password</label>
          <input class="auth-input" id="profile-new-password2" type="password" placeholder="Repeat new password" />
        </div>
        <div class="full-row" style="margin-top:0.2rem;">
          <button type="submit" class="auth-submit">Update password</button>
        </div>
      </form>
      <p class="auth-footnote">
        
      </p>
    </div>
  </div>
</section>
<section class="page-section" data-page="history" id="history">
  <h2>Purchase History</h2>
  <p class="section-lede">
    Review your previous orders.
  </p>
  <div id="purchase-history-list" style="margin-top:1rem;font-size:0.86rem;color:var(--text-muted);">
    <div>No purchases recorded yet.</div>
  </div>
</section>

</main>
<footer>
  Â© <span id="year"></span> Shrinxa. All rights reserved. Demo site for catalogue &amp; cart simulation.
</footer>
<!-- CART PANEL -->
<div aria-hidden="true" class="cart-panel" id="cartPanel">
<div class="cart-header">
<div>
<h3>Your cart</h3>
<div style="font-size:0.78rem;color:var(--text-muted);">
        All prices in CAD from current catalogue. 13% HST applied on subtotal and delivery.
      </div>
</div>
<button aria-label="Close cart" class="cart-close" id="closeCartBtn">Ã—</button>
</div>
<div class="cart-body" id="cartBody">
<div class="cart-empty">No items yet. Add products from the catalogue to see your simulated order.</div>
</div>
<div class="cart-footer">
<div class="cart-summary-row">
<span>Items</span>
<span id="cartItemsCount">0</span>
</div>
<div class="cart-summary-row">
<span>Subtotal (before HST)</span>
<span id="cartSubtotal">$0.00</span>
</div>
<div class="cart-summary-row">
<span>Estimated delivery</span>
<span id="cartDelivery">Calculated at quote</span>
</div>
<div class="cart-summary-row">
<span>Estimated HST (13%)</span>
<span id="cartTax">$0.00</span>
</div>
<div class="cart-summary-row total">
<span>Estimated total</span>
<span id="cartTotal">$0.00</span>
</div>
<div class="cart-summary-row"><span>Preferred payment</span><span><select id="cart-payment"><option value="pay_now">Pay now (Credit card / Interac e-Transfer)</option><option value="pay_delivery">Pay on Delivery (at your dock)</option></select></span></div><div class="cart-summary-note">Free delivery on orders over $300 within our GTA service area. Orders under $300 are estimated at a $30 GTA delivery charge.</div>
<button class="cart-checkout-btn" id="buyNow">Buy Now</button>
</div>
</div>
<div class="toast" id="toast">Done.</div>

<!-- PAYMENT MODAL -->
<div class="modal-backdrop" id="paymentModal" aria-hidden="true" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:1200;align-items:center;justify-content:center;">
  <div class="modal-card" style="background:rgba(6,10,30,0.98);border-radius:0.9rem;border:1px solid rgba(80,120,220,0.9);padding:1.5rem;max-width:480px;width:90%;box-shadow:0 18px 45px rgba(0,0,0,0.65);">
    <h3 style="margin-top:0;margin-bottom:0.75rem;font-size:1.05rem;">Payment details</h3>
    <p style="margin:0 0 1rem;font-size:0.85rem;color:var(--text-muted);">
      Enter your card details to complete your payment securely.
    </p>
    <form id="paymentForm" class="payment-form">
      <div style="margin-bottom:0.6rem;">
        <label style="display:block;font-size:0.8rem;margin-bottom:0.25rem;">Name on card</label>
        <input type="text" id="pay-name" required class="quote-input" placeholder="Full name"/>
      </div>
      <div style="margin-bottom:0.6rem;">
        <label style="display:block;font-size:0.8rem;margin-bottom:0.25rem;">Card number</label>
        <input type="text" id="pay-card" required class="quote-input" placeholder="0000 0000 0000 0000" maxlength="19"/>
      </div>
      <div style="display:flex;gap:0.6rem;margin-bottom:0.6rem;">
        <div style="flex:1;">
          <label style="display:block;font-size:0.8rem;margin-bottom:0.25rem;">Expiry (MM/YY)</label>
          <input type="text" id="pay-exp" required class="quote-input" placeholder="MM/YY" maxlength="5"/>
        </div>
        <div style="flex:1;">
          <label style="display:block;font-size:0.8rem;margin-bottom:0.25rem;">CVV</label>
          <input type="password" id="pay-cvv" required class="quote-input" placeholder="***" maxlength="4"/>
        </div>
      </div>
      <div style="display:flex;gap:0.6rem;margin-top:1rem;justify-content:flex-end;">
        <button type="button" id="paymentCancel" class="btn-ghost">Cancel</button>
        <button type="submit" class="btn-primary">Pay now</button>
      </div>
      <p style="margin-top:0.8rem;font-size:0.75rem;color:var(--text-muted);">
        * Demo only â€“ integrate your real payment gateway on the server side.
      </p>
    </form>
  </div>
</div>

<!-- INVOICE MODAL -->
<div class="modal-backdrop" id="invoiceModal" aria-hidden="true" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:1300;align-items:center;justify-content:center;">
  <div class="modal-card" style="background:#ffffff;border-radius:0.9rem;padding:1.4rem 1.5rem;max-width:720px;width:95%;max-height:calc(100vh - 40px);overflow-y:auto;box-shadow:0 18px 45px rgba(0,0,0,0.75);color:#111;">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem;">
      <div>
        <div style="border-radius:8px;border:1px solid #e5e7eb;padding:6px 10px;display:inline-block;background:#f9fafb;margin-left:-4px;">
          <h3 style="margin:0 0 0.15rem;font-size:1.05rem;">Invoice</h3>
          <div id="invoiceNumber" style="font-size:0.8rem;color:#555;"></div>
          <div id="invoiceDate" style="font-size:0.78rem;color:#6b7280;"></div>
        </div>
      </div>
      <div style="text-align:right;font-size:0.8rem;">
        <div style="margin-bottom:0.25rem;">
          <img src="shrinxa_transparent_4000px.png" alt="Shrinxa logo" style="height:60px;display:inline-block;vertical-align:middle;border-radius:999px;box-shadow:0 0 0 1px rgba(30,166,255,0.3);"/>
        </div>
        <div style="font-weight:600;">Shrinxa Packaging</div>
        <div>Premium Packaging Solutions</div>
        <div>info@shrinxa.com</div>
      </div>
    </div>

    <div style="display:flex;justify-content:space-between;gap:1.5rem;margin-bottom:1rem;font-size:0.82rem;">
      <div>
        <div style="font-weight:600;margin-bottom:0.25rem;">Bill to:</div>
        <div id="invoiceCustomerName"></div>
        <div id="invoiceCustomerCompany"></div>
        <div id="invoiceCustomerAddress"></div>
        <div id="invoiceCustomerPostal"></div>
        <div id="invoiceCustomerEmail"></div>
        <div id="invoiceCustomerPhone"></div>
      </div>
      <div>
        <div style="font-weight:600;margin-bottom:0.25rem;">Payment</div>
        <div id="invoicePaymentMethod"></div>
        <div id="invoicePaymentStatus"></div>
      </div>
    </div>

    <div style="border:1px solid #ddd;border-radius:0.4rem;overflow:hidden;margin-bottom:1rem;">
      <table style="width:100%;border-collapse:collapse;font-size:0.8rem;">
        <thead>
          <tr style="background:#f3f4f6;">
            <th style="text-align:left;padding:0.4rem 0.5rem;">Item</th>
            <th style="text-align:center;padding:0.4rem 0.5rem;">Qty</th>
            <th style="text-align:right;padding:0.4rem 0.5rem;">Unit price</th>
            <th style="text-align:right;padding:0.4rem 0.5rem;">Line total</th>
          </tr>
        </thead>
        <tbody id="invoiceItems">
        </tbody>
      </table>
    </div>

    <div style="display:flex;justify-content:flex-end;margin-bottom:0.5rem;font-size:0.82rem;">
      <div style="min-width:220px;">
        <div style="display:flex;justify-content:space-between;">
          <span>Subtotal</span>
          <span id="invoiceSubtotal"></span>
        </div>
        <div style="display:flex;justify-content:space-between;">
          <span>Delivery</span>
          <span id="invoiceDelivery"></span>
        </div>
        <div style="display:flex;justify-content:space-between;">
          <span>HST (13%)</span>
          <span id="invoiceTax"></span>
        </div>
        <div style="border-top:1px solid #ddd;margin-top:0.25rem;padding-top:0.25rem;font-weight:600;display:flex;justify-content:space-between;">
          <span>Total</span>
          <span id="invoiceTotal"></span>
        </div>
      </div>
    </div>

    <div style="margin-top:0.2rem;margin-bottom:0.2rem;font-size:0.8rem;color:#000;">
      <strong>Terms &amp; Conditions :</strong>
    </div>
    <div style="margin-bottom:0.4rem;font-size:0.8rem;color:#000;">
      Please send payment within 30 days of receiving this invoice.
    </div>
    <div style="font-size:1.4rem;color:#1b3a8a;margin-bottom:1.1rem;font-weight:900;">
      Thank you for your business with us.
    </div>

    <div class="invoice-actions" style="display:flex;justify-content:space-between;align-items:center;gap:0.75rem;">
      <div style="font-size:0.75rem;color:#666;">A copy of this invoice is emailed to the address on file.</div>
      <div style="display:flex;gap:0.5rem;justify-content:flex-end;">
        <button type="button" id="invoiceDownload" class="btn-ghost" style="padding:0.3rem 0.8rem;font-size:0.8rem;">Download</button>
        <button type="button" id="invoicePrint" class="btn-ghost" style="padding:0.3rem 0.8rem;font-size:0.8rem;">Print</button>
        <button type="button" id="invoiceClose" class="btn-primary" style="padding:0.35rem 1rem;font-size:0.82rem;">Close</button>
      </div>
    </div>
  </div>
</div>
<script>
  const yearSpan = document.getElementById("year");
  yearSpan.textContent = new Date().getFullYear();

  const cartPanel = document.getElementById("cartPanel");
  const openCartBtn = document.getElementById("openCartBtn");
  const closeCartBtn = document.getElementById("closeCartBtn");
  const cartBody = document.getElementById("cartBody");
  const cartItemsCount = document.getElementById("cartItemsCount");
  const cartSubtotal = document.getElementById("cartSubtotal");
  const cartTax = document.getElementById("cartTax");
  const cartDelivery = document.getElementById("cartDelivery");
  const cartTotal = document.getElementById("cartTotal");
  const cartCountBadge = document.getElementById("cartCount");
  const buyNowBtn = document.getElementById("buyNow");
  const toast = document.getElementById("toast");

  const paymentModal = document.getElementById("paymentModal");
  const paymentForm = document.getElementById("paymentForm");
  const paymentCancelBtn = document.getElementById("paymentCancel");

  const invoiceModal = document.getElementById("invoiceModal");
  const invoiceNumberEl = document.getElementById("invoiceNumber");
  const invoiceDateEl = document.getElementById("invoiceDate");
  const invoiceCustomerNameEl = document.getElementById("invoiceCustomerName");
  const invoiceCustomerCompanyEl = document.getElementById("invoiceCustomerCompany");
  const invoiceCustomerAddressEl = document.getElementById("invoiceCustomerAddress");
  const invoiceCustomerPostalEl = document.getElementById("invoiceCustomerPostal");
  const invoiceCustomerEmailEl = document.getElementById("invoiceCustomerEmail");
  const invoiceCustomerPhoneEl = document.getElementById("invoiceCustomerPhone");
  const invoicePaymentMethodEl = document.getElementById("invoicePaymentMethod");
  const invoicePaymentStatusEl = document.getElementById("invoicePaymentStatus");
  const invoiceItemsBody = document.getElementById("invoiceItems");
  const invoiceSubtotalEl = document.getElementById("invoiceSubtotal");
  const invoiceTaxEl = document.getElementById("invoiceTax");
  const invoiceDeliveryEl = document.getElementById("invoiceDelivery");
  const invoiceTotalEl = document.getElementById("invoiceTotal");
  const invoiceDownloadBtn = document.getElementById("invoiceDownload");
  const invoicePrintBtn = document.getElementById("invoicePrint");
  const invoiceCloseBtn = document.getElementById("invoiceClose");

  function openPaymentModal() {
    if (!paymentModal) return;
    if (!requireLogin()) return;
    paymentModal.style.display = "flex";
    paymentModal.setAttribute("aria-hidden", "false");
  }

  function closePaymentModal() {
    if (!paymentModal) return;
    paymentModal.style.display = "none";
    paymentModal.setAttribute("aria-hidden", "true");
  }

  function openInvoiceModal(options) {
    if (!invoiceModal) return;
    if (!requireLogin()) return;

    const ids = Object.keys(cart);
    if (!ids.length) return;

    const user = loadCurrentUser();

    const now = new Date();
    const num = "INV-" + now.getFullYear().toString().slice(-2)
      + String(now.getMonth() + 1).padStart(2, "0")
      + String(now.getDate()).padStart(2, "0")
      + "-" + String(Math.floor(Math.random() * 9000) + 1000);
    invoiceNumberEl.textContent = "Invoice #: " + num;
    invoiceDateEl.textContent = "Date: " + now.toLocaleDateString();

    // Bill to (with address line)
    invoiceCustomerNameEl.textContent = user && user.name ? user.name : "";
    invoiceCustomerCompanyEl.textContent = user && user.company ? user.company : "";
    invoiceCustomerAddressEl.textContent = user && user.address ? "Address: " + user.address : "";
    invoiceCustomerPostalEl.textContent = user && user.postal ? "Postal Code: " + user.postal : "";
    invoiceCustomerEmailEl.textContent = user && user.email ? user.email : "";
    invoiceCustomerPhoneEl.textContent = user && user.phone ? user.phone : "";

    const rules = getUserCartRules();
    let subtotal = 0;

    invoiceItemsBody.innerHTML = "";
    ids.forEach(id => {
      const line = cart[id];
      if (!line) return;
      const useWholesale = line.qty >= rules.wholesaleFrom;
      const pricePerUnit = useWholesale ? line.wholesale : line.retail;
      const lineTotal = pricePerUnit * line.qty;
      subtotal += lineTotal;

      const safeDesc = line.desc || "";
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td style="padding:0.35rem 0.5rem;border-top:1px solid #eee;">
          <div>${line.name}</div>
          ${safeDesc ? `<div style="font-size:0.75rem;color:#555;margin-top:0.1rem;">${safeDesc}</div>` : ""}
        </td>
        <td style="padding:0.35rem 0.5rem;border-top:1px solid #eee;text-align:center;">${line.qty}</td>
        <td style="padding:0.35rem 0.5rem;border-top:1px solid #eee;text-align:right;">${fmt(pricePerUnit)}</td>
        <td style="padding:0.35rem 0.5rem;border-top:1px solid #eee;text-align:right;">${fmt(lineTotal)}</td>
      `;
      invoiceItemsBody.appendChild(tr);
    });

    const delivery = subtotal >= rules.freeDeliveryFrom || subtotal === 0 ? 0 : 30;
    const taxBase = subtotal + delivery;
    const tax = taxBase * 0.13;
    const total = taxBase + tax;

    invoiceSubtotalEl.textContent = fmt(subtotal);
    invoiceTaxEl.textContent = fmt(tax);
    invoiceDeliveryEl.textContent = delivery === 0 ? "$0.00 (free)" : fmt(delivery);
    invoiceTotalEl.textContent = fmt(total);

    const methodLabel = options && options.paymentMethod === "pay_now"
      ? "Pay now (card)"
      : "Pay on delivery";
    const statusLabel = options && options.paymentMethod === "pay_now"
      ? (options.paymentCaptured ? "Paid in full" : "Payment pending")
      : "Payment due on delivery";

    invoicePaymentMethodEl.textContent = methodLabel;
    invoicePaymentStatusEl.textContent = statusLabel;

    // Build standalone invoice HTML and open in a new tab (no buttons)
    const htmlDoc = buildInvoiceDocumentHTML();
    const w = window.open("", "_blank");
    if (w) {
      w.document.open();
      w.document.write(htmlDoc);
      w.document.close();
      w.focus();
    }

    if (user && user.email) {
      console.log("Invoice emailed to:", user.email, "number", num);
      showToast("Invoice generated and emailed to " + user.email + " (demo).");
    }

    // Record purchase history for this customer
    if (user && !user.role && user.email) {
      const orderItems = ids.map(id => {
        const line = cart[id];
        const useWholesale = line.qty >= rules.wholesaleFrom;
        const pricePerUnit = useWholesale ? line.wholesale : line.retail;
        const lineTotal = pricePerUnit * line.qty;
        return {
          productId: id,
          name: line.name,
          qty: line.qty,
          unitPrice: pricePerUnit,
          lineTotal
        };
      });
      const order = {
        invoiceNumber: num,
        date: now.toISOString(),
        items: orderItems,
        subtotal,
        delivery,
        tax,
        total,
        paymentMethod: methodLabel,
        paymentStatus: statusLabel
      };
      const allUsers = loadUsers();
      const idx = allUsers.findIndex(u => u.email === user.email);
      if (idx !== -1) {
        const existing = allUsers[idx].purchaseHistory || [];
        const updatedUser = {
          ...allUsers[idx],
          // clear persistent cart after completed purchase
          cart: {},
          purchaseHistory: [...existing, order]
        };
        allUsers[idx] = updatedUser;
        saveUsers(allUsers);
        saveCurrentUser(updatedUser);
      }
    }

    // Clear cart immediately after generating invoice
    Object.keys(cart).forEach(id => delete cart[id]);
    updateCart();
    closeCart();
  }

  function closeInvoiceModalAndClearCart() {
    if (invoiceModal) {
      invoiceModal.style.display = "none";
      invoiceModal.setAttribute("aria-hidden", "true");
    }

    // Clear cart when invoice is closed
    for (const id in cart) {
      if (Object.prototype.hasOwnProperty.call(cart, id)) {
        delete cart[id];
      }
    }
    updateCart();
    closeCart();
  }

  const cart = {}; // id -> {name, desc, retail, wholesale, qty}

  const userMenu = document.getElementById("user-menu");
  const userMenuName = document.getElementById("userMenuName");
  const userMenuToggle = document.getElementById("userMenuToggle");
  const userMenuDropdown = document.getElementById("userMenuDropdown");

  function populateProfileFormFromCurrentUser() {
    const form = document.getElementById("profile-form");
    if (!form) return;
    const u = loadCurrentUser();
    if (!u || u.role === "admin") return;
    const nameEl = document.getElementById("profile-name");
    const compEl = document.getElementById("profile-company");
    const typeEl = document.getElementById("profile-type");
    const emailEl = document.getElementById("profile-email");
    const phoneEl = document.getElementById("profile-phone");
    const addrEl = document.getElementById("profile-address");
    const postalEl = document.getElementById("profile-postal");
    const tierEl = document.getElementById("profile-tier");

    if (nameEl) nameEl.value = u.name || "";
    if (compEl) compEl.value = u.company || "";
    if (typeEl) typeEl.value = u.type || "warehouse";
    if (emailEl) emailEl.value = u.email || "";
    if (phoneEl) phoneEl.value = u.phone || "";
    if (addrEl) addrEl.value = u.address || "";
    if (postalEl) postalEl.value = u.postal || "";
    if (tierEl) tierEl.value = (u.tier || "standard").toUpperCase();
  }

  function persistCartForCurrentUser() {
    const u = loadCurrentUser();
    if (!u || u.role === "admin") return;
    const users = loadUsers();
    const idx = users.findIndex(x => x.email === u.email);
    if (idx === -1) return;

    const snapshot = {};
    Object.entries(cart).forEach(([id, line]) => {
      snapshot[id] = { qty: line.qty };
    });

    const updatedUser = { ...users[idx], cart: snapshot };
    users[idx] = updatedUser;
    saveUsers(users);
    saveCurrentUser(updatedUser);
  }

  function hydrateCartFromUser(user) {
    if (!user || user.role === "admin" || !user.cart) return;
    for (const id in cart) {
      if (Object.prototype.hasOwnProperty.call(cart, id)) {
        delete cart[id];
      }
    }
    Object.entries(user.cart).forEach(([id, info]) => {
      const qty = info && typeof info.qty === "number" ? info.qty : 0;
      if (!qty || qty <= 0) return;
      const card = document.querySelector('.product-card[data-id="' + id + '"]');
      if (!card) return;
      const name = card.dataset.name;
      const specEl = card.querySelector(".prod-spec");
      const categoryEl = card.querySelector(".prod-category");
      const specText = specEl ? specEl.textContent.trim() : "";
      const categoryText = categoryEl ? categoryEl.textContent.trim() : "";
      const desc = specText ? (categoryText ? categoryText + " â€“ " + specText : specText) : categoryText;

      const baseWholesale = parseFloat(card.dataset.wholesale);
      const baseRetail = parseFloat(card.dataset.retail);
      const goldWholesale = parseFloat(card.dataset.wholesaleGold || card.dataset.wholesale);
      const goldRetail = parseFloat(card.dataset.retailGold || card.dataset.retail);

      const prices = getEffectivePricesForCurrentUser(
        id,
        baseRetail,
        baseWholesale,
        goldRetail,
        goldWholesale
      );
      const retail = prices.retail;
      const wholesale = prices.wholesale;

      cart[id] = { name, desc, retail, wholesale, qty };
    });
    updateCart();
  }

  function signOutCurrentUser() {
    const u = loadCurrentUser();
    if (u) {
      saveCurrentUser(null);
    }
    for (const id in cart) {
      if (Object.prototype.hasOwnProperty.call(cart, id)) {
        delete cart[id];
      }
    }
    updateCart();
    closeCart();
    applyUserGreeting();
    updateVisiblePricesForTier();
    setView("home");
  }

  function renderPurchaseHistory() {
    const container = document.getElementById("purchase-history-list");
    if (!container) return;
    const u = loadCurrentUser();
    if (!u || u.role === "admin") {
      container.innerHTML = "";
      return;
    }
    const history = u.purchaseHistory || [];
    if (!history.length) {
      container.innerHTML = "<div>No purchases recorded yet.</div>";
      return;
    }
    const parts = [];
    history.slice().reverse().forEach(order => {
      const dateStr = order.date ? new Date(order.date).toLocaleString() : "";
      const itemsCount = order.items ? order.items.reduce((sum, it) => sum + (it.qty || 0), 0) : 0;
      const total = typeof order.total === "number" ? fmt(order.total) : "";
      const status = order.paymentStatus || "";
      const method = order.paymentMethod || "";
      const invoice = order.invoiceNumber || "";
      let itemsHtml = "";
      if (order.items && order.items.length) {
        itemsHtml = "<ul style='margin:0.35rem 0 0.1rem 1rem;font-size:0.8rem;'>" +
          order.items.map(it => {
            const qty = it.qty || 0;
            const name = it.name || "";
            const unit = typeof it.unitPrice === "number" ? fmt(it.unitPrice) : "";
            return "<li>" + qty + " Ã— " + name + (unit ? " (" + unit + "/box)" : "") + "</li>";
          }).join("") +
          "</ul>";
      }
      parts.push(
        "<article style='border-radius:0.9rem;border:1px solid rgba(80,110,170,0.7);padding:0.55rem 0.75rem;margin-bottom:0.55rem;background:rgba(6,11,25,0.95);'>"+
          "<div style='display:flex;justify-content:space-between;gap:0.75rem;align-items:center;margin-bottom:0.15rem;'>" +
            "<div style='font-weight:500;color:var(--text-main);font-size:0.9rem;'>Invoice " + (invoice || "#") + "</div>" +
            "<div style='font-size:0.78rem;color:var(--text-muted);'>" + dateStr + "</div>" +
          "</div>" +
          "<div style='display:flex;flex-wrap:wrap;gap:0.65rem;font-size:0.8rem;color:var(--text-muted);'>" +
            "<span>Items: " + itemsCount + "</span>" +
            (total ? "<span>Total: <strong>" + total + "</strong></span>" : "") +
            (status ? "<span>Status: " + status + "</span>" : "") +
            (method ? "<span>Paid by: " + method + "</span>" : "") +
          "</div>" +
          itemsHtml +
        "</article>"
      );
    });
    container.innerHTML = parts.join("");
  }


  // --- Simple demo account system (local to this browser) ---
  const STORAGE_KEY_USERS = "shrinxaUsers";
  const STORAGE_KEY_CURRENT = "shrinxaCurrentUser";
  const greetingEl = document.getElementById("user-greeting");

  function loadUsers() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY_USERS);
      return raw ? JSON.parse(raw) : [];
    } catch (e) {
      return [];
    }
  }

  function saveUsers(users) {
    try {
      localStorage.setItem(STORAGE_KEY_USERS, JSON.stringify(users));
    } catch (e) {
      console.warn("Unable to save users", e);
    }
  }

  function loadCurrentUser() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY_CURRENT);
      return raw ? JSON.parse(raw) : null;
    } catch (e) {
      return null;
    }
  }

  
  function requireLogin() {
    const user = loadCurrentUser();
    if (!user) {
      // Redirect to dedicated login page
      const next = window.location.pathname + window.location.search + window.location.hash;
      window.location.href = "login.html?next=" + encodeURIComponent(next);
      return false;
    }
    return true;
  }

function saveCurrentUser(user) {
    try {
      if (user) {
        localStorage.setItem(STORAGE_KEY_CURRENT, JSON.stringify(user));
      } else {
        localStorage.removeItem(STORAGE_KEY_CURRENT);
      }
    } catch (e) {
      console.warn("Unable to save current user", e);
    }
  }

  function getCurrentTier() {
    const u = loadCurrentUser();
    return u && u.tier ? u.tier : "standard";
  }

  function isAdmin() {
    const u = loadCurrentUser();
    return !!(u && u.role === "admin");
  }

  
function applyUserGreeting() {
    const u = loadCurrentUser();
    if (u && u.name) {
      greetingEl.textContent = "";
      if (userMenu && userMenuName) {
        userMenu.style.display = "flex";
        userMenuName.textContent = u.name;
      }
    } else {
      greetingEl.textContent = "";
      if (userMenu) {
        userMenu.style.display = "none";
      }
    }
    const signLinks = document.querySelectorAll(".nav-signin");
    signLinks.forEach(link => {
      if (u && u.name) {
        link.style.display = "none";
      } else {
        link.style.display = "";
        link.textContent = "Sign in";
      }
    });

    const adminLinks = document.querySelectorAll(".nav-admin");
    adminLinks.forEach(link => {
      if (u && u.role === "admin") {
        link.style.display = "";
      } else {
        link.style.display = "none";
      }
    });
  }


  // Per-customer thresholds (free delivery + wholesale breakpoint)
  function getUserCartRules() {
    const u = loadCurrentUser();
    const freeDeliveryFrom =
      u && typeof u.freeDeliveryFrom === "number" ? u.freeDeliveryFrom : 300;
    const wholesaleFrom =
      u && typeof u.wholesaleFrom === "number" ? u.wholesaleFrom : 50;
    return { freeDeliveryFrom, wholesaleFrom };
  }

  // Per-customer effective retail / wholesale, including Platinum overrides
  function getEffectivePricesForCurrentUser(productId, baseRetail, baseWholesale, goldRetail, goldWholesale) {
    const tier = getCurrentTier();
    const u = loadCurrentUser();

    let retail = baseRetail;
    let wholesale = baseWholesale;

    if (tier === "gold") {
      retail = goldRetail || baseRetail;
      wholesale = goldWholesale || baseWholesale;
    } else if (tier === "platinum") {
      // Start from gold level
      retail = goldRetail || baseRetail;
      wholesale = goldWholesale || baseWholesale;

      if (u && u.platinumPrices && u.platinumPrices[productId]) {
        const custom = u.platinumPrices[productId];
        if (typeof custom.retail === "number") retail = custom.retail;
        if (typeof custom.wholesale === "number") wholesale = custom.wholesale;
      }
    }

    return { retail, wholesale };
  }

  function updateVisiblePricesForTier() {
    const tier = getCurrentTier();
    document.querySelectorAll(".product-card").forEach(card => {
      const retailEl = card.querySelector(".prod-prices span.price-chip:nth-child(1) strong");
      const wholesaleEl = card.querySelector(".prod-prices span.price-chip:nth-child(2) strong");
      if (!retailEl || !wholesaleEl) return;

      const id = card.dataset.id;
      const baseRetail = parseFloat(card.dataset.retail);
      const baseWholesale = parseFloat(card.dataset.wholesale);
      const goldRetail = parseFloat(card.dataset.retailGold || card.dataset.retail);
      const goldWholesale = parseFloat(card.dataset.wholesaleGold || card.dataset.wholesale);

      const prices = getEffectivePricesForCurrentUser(
        id,
        baseRetail,
        baseWholesale,
        goldRetail,
        goldWholesale
      );

      retailEl.textContent = fmt(prices.retail);
      wholesaleEl.textContent = fmt(prices.wholesale);
    });
  }


function initAuthFlows() {
    applyUserGreeting();
    updateVisiblePricesForTier();

    const current = loadCurrentUser();
    if (current && current.role !== "admin") {
      hydrateCartFromUser(current);
    }

    const signinForm = document.getElementById("signin-form");
    const signupForm = document.getElementById("signup-form");
    const profileForm = document.getElementById("profile-form");
    const passwordForm = document.getElementById("password-form");

    if (signupForm) {
      signupForm.addEventListener("submit", (e) => {

        const name = document.getElementById("signup-name").value.trim();
        const email = document.getElementById("signup-email").value.trim().toLowerCase();
        const password = document.getElementById("signup-password").value;
        const password2 = document.getElementById("signup-password2").value;
        const terms = document.getElementById("signup-terms").checked;
        const company = document.getElementById("signup-company").value.trim();
        const phone = document.getElementById("signup-phone").value.trim();
        const address = document.getElementById("signup-address").value.trim();
        const postal = document.getElementById("signup-postal").value.trim();
        const type = document.getElementById("signup-type").value;

        if (!name || !email || !password || !password2) {
          alert("Please fill in all required fields.");
          return;
        }
        if (password !== password2) {
          alert("Passwords do not match.");
          return;
        }
        if (!terms) {
          alert("Please agree to be contacted so we can send you quotes.");
          return;
        }

        const users = loadUsers();
        if (users.some(u => u.email === email)) {
          alert("An account with this email already exists. Please sign in instead.");
          return;
        }

        const user = {
          name,
          email,
          password,
          company,
          phone,
          address,
          postal,
          type,
          tier: "standard",
          cart: {},
          purchaseHistory: []
        };

        users.push(user);
        saveUsers(users);
        saveCurrentUser(user);
        alert("Account created! You are now signed in.");
        applyUserGreeting();
        updateVisiblePricesForTier();
        hydrateCartFromUser(user);
        setView("home");
      });
    }

    if (signinForm) {
      signinForm.addEventListener("submit", (e) => {

        const email = document.getElementById("signin-email").value.trim().toLowerCase();
        const password = document.getElementById("signin-password").value;
        if (!email || !password) {
          alert("Please enter your email and password.");
          return;
        }

        if (email === "admin@shrinxa.com" && password === "Admin123!") {
          const adminUser = {
            name: "Shrinxa Admin",
            email,
            role: "admin",
            tier: "platinum"
          };
          saveCurrentUser(adminUser);
          applyUserGreeting();
          updateVisiblePricesForTier();
          alert("Signed in as admin.");
          setView("admin");
          buildAdminCustomersUI();
          return;
        }

        const users = loadUsers();
        const match = users.find(u => u.email === email && u.password === password);
        if (!match) {
          alert("Account not found. Please check your details or create a new account.");
          return;
        }
        saveCurrentUser(match);
        applyUserGreeting();
        updateVisiblePricesForTier();
        hydrateCartFromUser(match);
        alert("Signed in as " + (match.name || match.email) + ".");
        setView("home");
      });
    }


    // Prefill profile form when present
    if (profileForm) {
      populateProfileFormFromCurrentUser();

      profileForm.addEventListener("submit", (e) => {

        const u2 = loadCurrentUser();
        if (!u2 || u2.role === "admin") {
          alert("Please sign in as a customer to update your profile.");
          return;
        }
        const users = loadUsers();
        const idx = users.findIndex(x => x.email === u2.email);
        if (idx === -1) {
          alert("Unable to update profile (user not found).");
          return;
        }
        const updated = {
          ...users[idx],
          name: document.getElementById("profile-name").value.trim(),
          company: document.getElementById("profile-company").value.trim(),
          type: document.getElementById("profile-type").value,
          phone: document.getElementById("profile-phone").value.trim(),
          address: document.getElementById("profile-address").value.trim(),
          postal: document.getElementById("profile-postal").value.trim()
        };
        users[idx] = updated;
        saveUsers(users);
        saveCurrentUser(updated);
        applyUserGreeting();
        alert("Profile updated.");
      });
    }

    if (passwordForm) {
      passwordForm.addEventListener("submit", (e) => {

        const currentPw = document.getElementById("profile-current-password").value;
        const newPw = document.getElementById("profile-new-password").value;
        const newPw2 = document.getElementById("profile-new-password2").value;

        const u = loadCurrentUser();
        if (!u || u.role === "admin") {
          alert("Please sign in as a customer to change your password.");
          return;
        }
        if (!currentPw || !newPw || !newPw2) {
          alert("Please fill in all password fields.");
          return;
        }
        if (currentPw !== u.password) {
          alert("Current password is incorrect.");
          return;
        }
        if (newPw !== newPw2) {
          alert("New passwords do not match.");
          return;
        }
        const users = loadUsers();
        const idx = users.findIndex(x => x.email === u.email);
        if (idx === -1) {
          alert("Unable to update password (user not found).");
          return;
        }
        const updated = { ...users[idx], password: newPw };
        users[idx] = updated;
        saveUsers(users);
        saveCurrentUser(updated);
        document.getElementById("profile-current-password").value = "";
        document.getElementById("profile-new-password").value = "";
        document.getElementById("profile-new-password2").value = "";
        alert("Password updated successfully.");
      });
    }

    // User menu dropdown
    if (userMenuToggle && userMenuDropdown) {
      userMenuToggle.addEventListener("click", () => {
        userMenuDropdown.classList.toggle("open");
      });

      userMenuDropdown.addEventListener("click", (e) => {
        const btn = e.target.closest(".user-menu-item");
        if (!btn) return;
        const action = btn.dataset.action;
        userMenuDropdown.classList.remove("open");
        if (action === "profile") {
          populateProfileFormFromCurrentUser();
          setView("profile");
        } else if (action === "history") {
          setView("history");
          renderPurchaseHistory();
        } else if (action === "signout") {
          signOutCurrentUser();
        }
      });

      document.addEventListener("click", (e) => {
        if (!userMenu.contains(e.target) && userMenuDropdown.classList.contains("open")) {
          userMenuDropdown.classList.remove("open");
        }
      });
    }
}
function fmt(n) {
    return "$" + n.toFixed(2);
  }

  function openCart() {
    cartPanel.classList.add("open");
    cartPanel.setAttribute("aria-hidden", "false");
  }
  function closeCart() {
    cartPanel.classList.remove("open");
    cartPanel.setAttribute("aria-hidden", "true");
  }

  openCartBtn.addEventListener("click", openCart);
  closeCartBtn.addEventListener("click", closeCart);

  // Add to cart buttons
  document.querySelectorAll(".product-card .btn-add").forEach(btn => {
    btn.addEventListener("click", () => {
      if (!requireLogin()) return;
      const card = btn.closest(".product-card");
      const id = card.dataset.id;
      const name = card.dataset.name;
      const specEl = card.querySelector(".prod-spec");
      const categoryEl = card.querySelector(".prod-category");
      const specText = specEl ? specEl.textContent.trim() : "";
      const categoryText = categoryEl ? categoryEl.textContent.trim() : "";
      const desc = specText ? (categoryText ? categoryText + " â€“ " + specText : specText) : categoryText;
      const baseWholesale = parseFloat(card.dataset.wholesale);
      const baseRetail = parseFloat(card.dataset.retail);
      const goldWholesale = parseFloat(card.dataset.wholesaleGold || card.dataset.wholesale);
      const goldRetail = parseFloat(card.dataset.retailGold || card.dataset.retail);

      const prices = getEffectivePricesForCurrentUser(
        id,
        baseRetail,
        baseWholesale,
        goldRetail,
        goldWholesale
      );
      const retail = prices.retail;
      const wholesale = prices.wholesale;

      const qtyInput = card.querySelector(".qty-input");
      const qty = Math.max(1, parseInt(qtyInput.value, 10) || 1);

      if (!cart[id]) {
        cart[id] = { name, desc, retail, wholesale, qty };
      } else {
        cart[id].qty += qty;
        // Keep latest pricing in case tier changed since last add
        cart[id].retail = retail;
        cart[id].wholesale = wholesale;
      }
      updateCart();
      openCart();
      showToast("Added to cart (tiered pricing applied).");
    });
  });

  function updateCart() {
  const { freeDeliveryFrom, wholesaleFrom } = getUserCartRules();

  let subtotal = 0;
  let itemsCount = 0;
  cartBody.innerHTML = "";

  const tier = getCurrentTier();
  const tierLabel =
    tier === "gold"
      ? "(Gold price per box)"
      : tier === "platinum"
        ? "(Platinum price per box)"
        : "(Standard price per box)";

  const entries = Object.entries(cart);
  if (!entries.length) {
    cartBody.innerHTML = '<div class="cart-empty">Your cart is empty.</div>';
    cartItemsCount.textContent = "0";
    cartSubtotal.textContent = fmt(0);
    cartTax.textContent = fmt(0);
    cartDelivery.textContent = fmt(0);
    cartTotal.textContent = fmt(0);
    cartCountBadge.textContent = "0";
    return;
  }

  entries.forEach(([id, line]) => {
    const useWholesale = line.qty >= wholesaleFrom;
    const pricePerUnit = useWholesale ? line.wholesale : line.retail;
    const lineTotal = pricePerUnit * line.qty;
    subtotal += lineTotal;
    itemsCount += line.qty;

    const div = document.createElement("div");
    div.className = "cart-item";
    div.innerHTML = `
      <div class="cart-item-header">
        <div>
          <div style="font-size:0.86rem;">${line.name}</div>
          <div style="font-size:0.76rem;color:var(--text-muted);">
            ${fmt(pricePerUnit)} ${useWholesale ? "(wholesale)" : "(retail)"} &nbsp;â€¢&nbsp; Qty: ${line.qty}
          </div>
        </div>
        <button class="cart-remove" data-id="${id}" aria-label="Remove item"
          style="border-radius:999px;border:1px solid rgba(84,112,173,0.95);background:rgba(10,18,40,0.96);color:var(--text-muted);cursor:pointer;min-width:24px;height:24px;font-size:0.9rem;line-height:1;">
          Ã—
        </button>
      </div>
      <div class="cart-item-controls"
           style="margin-top:0.35rem;display:flex;justify-content:space-between;align-items:center;gap:0.5rem;">
        <div class="cart-qty-control" style="display:flex;align-items:center;gap:0.25rem;">
          <button class="qty-btn" data-action="dec" data-id="${id}"
            style="min-width:24px;height:24px;border-radius:999px;border:1px solid rgba(84,112,173,0.95);background:rgba(10,18,40,0.96);color:var(--text-muted);cursor:pointer;">
            -
          </button>
          <input class="cart-qty-input" data-id="${id}" type="number" min="1"
            value="${line.qty}"
            style="width:48px;text-align:center;border-radius:0.4rem;border:1px solid rgba(84,112,173,0.95);background:rgba(5,10,26,0.95);color:var(--text-main);font-size:0.8rem;padding:0.2rem 0.3rem;">
          <button class="qty-btn" data-action="inc" data-id="${id}"
            style="min-width:24px;height:24px;border-radius:999px;border:1px solid rgba(84,112,173,0.95);background:rgba(10,18,40,0.96);color:var(--text-muted);cursor:pointer;">
            +
          </button>
        </div>
        <div class="cart-line-total" data-id="${id}" style="font-weight:500;">
          ${fmt(lineTotal)}
        </div>
      </div>
    `;
    cartBody.appendChild(div);
  });

  const delivery = subtotal >= freeDeliveryFrom || subtotal === 0 ? 0 : 30;
  const taxBase = subtotal + delivery;
  const tax = taxBase * 0.13;
  const total = taxBase + tax;

  cartSubtotal.textContent = fmt(subtotal);
  cartDelivery.textContent = fmt(delivery);
  cartTax.textContent = fmt(tax);
  cartTotal.textContent = fmt(total);


  cartItemsCount.textContent = itemsCount.toString();
  cartCountBadge.textContent = itemsCount.toString();

  // Persist cart per signed-in customer
  persistCartForCurrentUser();
}

// Cart quantity + remove controls
cartBody.addEventListener("click", (e) => {
  const qtyBtn = e.target.closest(".qty-btn");
  if (qtyBtn) {
    const id = qtyBtn.dataset.id;
    const line = cart[id];
    if (!line) return;

    if (qtyBtn.dataset.action === "inc") {
      line.qty += 1;
    } else if (qtyBtn.dataset.action === "dec") {
      line.qty -= 1;
      if (line.qty <= 0) {
        delete cart[id];
      }
    }
    updateCart();
    return;
  }

  const removeBtn = e.target.closest(".cart-remove");
  if (removeBtn) {
    const id = removeBtn.dataset.id;
    if (cart[id]) {
      delete cart[id];
      updateCart();
    }
  }
});

cartBody.addEventListener("change", (e) => {
  if (!e.target.classList.contains("cart-qty-input")) return;
  const input = e.target;
  const id = input.dataset.id;
  const line = cart[id];
  if (!line) return;

  let val = parseInt(input.value, 10);
  if (!val || val < 1) {
    delete cart[id];
  } else {
    line.qty = val;
  }
  updateCart();
});


  // Buy Now handler (Pay now / Pay on delivery)
  if (buyNowBtn) {
    buyNowBtn.addEventListener("click", () => {
      const ids = Object.keys(cart);
      if (!ids.length) {
        alert("Your cart is empty.");
        return;
      }

      const paymentSelect = document.getElementById("cart-payment");
      const paymentMethod = paymentSelect ? paymentSelect.value : "pay_delivery";

      if (paymentMethod === "pay_now") {
        openPaymentModal();
      } else {
        openInvoiceModal({ paymentMethod: "pay_delivery", paymentCaptured: false });
      }
    });
  }

  // Payment form events
  if (paymentForm) {
    paymentForm.addEventListener("submit", (e) => {

      const nameVal = document.getElementById("pay-name").value.trim();
      const cardVal = document.getElementById("pay-card").value.trim();
      const expVal = document.getElementById("pay-exp").value.trim();
      const cvvVal = document.getElementById("pay-cvv").value.trim();

      if (!nameVal || !cardVal || !expVal || !cvvVal) {
        alert("Please fill in all payment fields.");
        return;
      }

      if (cardVal.replace(/\s+/g, "").length < 12) {
        alert("Please enter a valid card number (demo check).");
        return;
      }

      closePaymentModal();
      showToast("Payment processed (demo).");

      openInvoiceModal({ paymentMethod: "pay_now", paymentCaptured: true });
    });
  }

  if (paymentCancelBtn) {
    paymentCancelBtn.addEventListener("click", () => {
      closePaymentModal();
    });
  }

  // Invoice actions â€“ print & download (A4 layout, no buttons on export)
  function buildInvoiceDocumentHTML() {
    const title = invoiceNumberEl.textContent || "Invoice";
    const rowsHTML = invoiceItemsBody.innerHTML;

    return `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>${title}</title>
<style>
  @page { size: A4; margin: 12mm; }
  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    margin: 0;
    padding: 0;
    color: #111;
    background: #ffffff;
  }

  .invoice-page { max-width: 720px; margin: 0 auto; padding: 12mm; }
  
  .invoice-page > * {
    position:relative;
    z-index:1;
  }

  h1, h2, h3, h4 {
    margin: 0;
    font-weight: 600;
  }
  .inv-header {
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    margin-bottom:12px;
  }
  .inv-meta {
    font-size: 0.8rem;
    color:#555;
  }
  table {
    width:100%;
    border-collapse:collapse;
    font-size:0.8rem;
    margin-top:4px;
  }
  thead tr {
    background:#f3f4f6;
  }
  th, td {
    padding:4px 6px;
    border-top:1px solid #e5e7eb;
  }
  th {
    text-align:left;
  }
  th:nth-child(2), td:nth-child(2) { text-align:center; }
  th:nth-child(3), td:nth-child(3),
  th:nth-child(4), td:nth-child(4) { text-align:right; }
  .inv-totals {
    margin-top:10px;
    display:flex;
    justify-content:flex-end;
  }
  .inv-totals-inner {
    min-width:220px;
    font-size:0.82rem;
  }
  .inv-totals-inner div {
    display:flex;
    justify-content:space-between;
  }
  .inv-totals-inner div.total {
    border-top:1px solid #e5e7eb;
    margin-top:4px;
    padding-top:4px;
    font-weight:600;
  }
  .inv-billto {
    display:flex;
    justify-content:space-between;
    gap:16px;
    font-size:0.82rem;
    margin-bottom:8px;
  }
  .muted {
    color:#555;
    font-size:0.75rem;
  }
</style>
</head>
<body>
<div class="invoice-page">
  <div class="inv-header">
    <div>
      <div style="border-radius:8px;border:1px solid #e5e7eb;padding:6px 10px;display:inline-block;background:#f9fafb;margin-left:-4px;">
        <h3 style="margin:0 0 2px;">Invoice</h3>
        <div class="inv-meta">${invoiceNumberEl.textContent || ""}</div>
        <div class="inv-meta">${invoiceDateEl.textContent || ""}</div>
      </div>
    </div>
    <div style="text-align:right;font-size:0.8rem;">
      <div style="margin-bottom:2px;">
        <img src="shrinxa_transparent_4000px.png" alt="Shrinxa logo" style="height:60px;border-radius:999px;box-shadow:0 0 0 1px rgba(30,166,255,0.3);" />
      </div>
      <div style="font-weight:600;">Shrinxa Packaging</div>
      <div>Premium Packaging Solutions</div>
      <div>info@shrinxa.com</div>
    </div>
  </div>

  <div class="inv-billto">
    <div>
      <div style="font-weight:600;margin-bottom:2px;">Bill to:</div>
      <div>${invoiceCustomerNameEl.textContent || ""}</div>
      <div>${invoiceCustomerCompanyEl.textContent || ""}</div>
      <div>${invoiceCustomerAddressEl.textContent || ""}</div>
      <div>${invoiceCustomerPostalEl.textContent || ""}</div>
      <div>${invoiceCustomerEmailEl.textContent || ""}</div>
      <div>${invoiceCustomerPhoneEl.textContent || ""}</div>
    </div>
    <div>
      <div style="font-weight:600;margin-bottom:2px;">Payment</div>
      <div>${invoicePaymentMethodEl.textContent || ""}</div>
      <div>${invoicePaymentStatusEl.textContent || ""}</div>
    </div>
  </div>

  <div style="border:1px solid #e5e7eb;border-radius:4px;overflow:hidden;">
    <table>
      <thead>
        <tr>
          <th>Item</th>
          <th>Qty</th>
          <th>Unit price</th>
          <th>Line total</th>
        </tr>
      </thead>
      <tbody>
        ${rowsHTML}
      </tbody>
    </table>
  </div>

  <div class="inv-totals">
    <div class="inv-totals-inner">
      <div>
        <span>Subtotal</span>
        <span>${invoiceSubtotalEl.textContent || ""}</span>
      </div>
      <div>
        <span>Delivery</span>
        <span>${invoiceDeliveryEl.textContent || ""}</span>
      </div>
      <div>
        <span>HST (13%)</span>
        <span>${invoiceTaxEl.textContent || ""}</span>
      </div>
      <div class="total">
        <span>Total</span>
        <span>${invoiceTotalEl.textContent || ""}</span>
      </div>
    </div>
  </div>

  <div style="margin-top:8px;font-size:0.85rem;color:#000;">
    <strong>Terms &amp; Conditions :</strong>
  </div>
  <div style="font-size:0.85rem;color:#000;margin-bottom:6px;">
    Please send payment within 30 days of receiving this invoice.
  </div>
  <p class="muted" style="margin-top:12px;font-weight:900;color:#1b3a8a;font-size:1.4rem;">
    Thank you for your business with us.
  </p>
</div>

</body>
</html>
    `;
  }

  if (invoicePrintBtn) {
    invoicePrintBtn.addEventListener("click", () => {
      const htmlDoc = buildInvoiceDocumentHTML();
      const w = window.open("", "_blank");
      if (!w) return;
      w.document.open();
      w.document.write(htmlDoc);
      w.document.close();
      w.focus();
      w.print();
    });
  }

  if (invoiceDownloadBtn) {
    invoiceDownloadBtn.addEventListener("click", () => {
      const htmlDoc = buildInvoiceDocumentHTML();
      const w = window.open("", "_blank");
      if (!w) return;
      w.document.open();
      w.document.write(htmlDoc);
      w.document.close();
      w.focus();
      // Let customer choose "Save as PDF" in the dialog
      w.print();
    });
  }

  if (invoiceCloseBtn) {
    invoiceCloseBtn.addEventListener("click", () => {
      closeInvoiceModalAndClearCart();
    });
  }

function buildAdminCustomersUI() {
    const listEl = document.getElementById("admin-customers-list");
    const emptyEl = document.getElementById("admin-customers-empty");
    if (!listEl) return;

    const users = loadUsers();
    const customers = users.filter(u => !u.role); // Skip admin or other special roles

    listEl.innerHTML = "";
    if (!customers.length) {
      if (emptyEl) emptyEl.style.display = "block";
      return;
    }
    if (emptyEl) emptyEl.style.display = "none";

    customers.forEach(user => {
      const card = document.createElement("div");
      card.className = "admin-customer-card";
      card.dataset.email = user.email;

      const tier = user.tier || "standard";
      const freeDeliveryFrom =
        typeof user.freeDeliveryFrom === "number" ? user.freeDeliveryFrom : 300;
      const wholesaleFrom =
        typeof user.wholesaleFrom === "number" ? user.wholesaleFrom : 50;

      card.innerHTML = `
        <div class="admin-customer-main">
          <div class="admin-customer-header">
            <div class="admin-customer-name">${user.name || "(No name)"}</div>
            <div class="admin-customer-email">${user.email}</div>
          </div>
          <div class="admin-customer-fields">
            <label>
              Tier
              <select class="admin-tier-select">
                <option value="standard"${tier === "standard" ? " selected" : ""}>Standard</option>
                <option value="gold"${tier === "gold" ? " selected" : ""}>Gold</option>
                <option value="platinum"${tier === "platinum" ? " selected" : ""}>Platinum</option>
              </select>
            </label>
            <label>
              Free delivery from ($)
              <input type="number" min="0" class="admin-free-delivery" value="${freeDeliveryFrom}">
            </label>
            <label>
              Wholesale starts at (boxes)
              <input type="number" min="1" class="admin-wholesale-from" value="${wholesaleFrom}">
            </label>
          </div>
          <button type="button" class="btn-primary admin-save-btn">Save changes</button>
        </div>
        <div class="admin-customer-platinum" style="display:${tier === "platinum" ? "block" : "none"};">
          <h4>Platinum prices for this customer</h4>
          <div class="admin-prices-grid"></div>
        </div>
      `;

      listEl.appendChild(card);

      const tierSelect = card.querySelector(".admin-tier-select");
      const platinumBox = card.querySelector(".admin-customer-platinum");
      const pricesGrid = card.querySelector(".admin-prices-grid");

      function ensurePricesGridBuilt() {
        if (!pricesGrid || pricesGrid.childElementCount) return;

        const allCards = document.querySelectorAll(".product-card");
        const perProd = user.platinumPrices || {};

        allCards.forEach(prodCard => {
          const pid = prodCard.dataset.id;
          const pname = prodCard.dataset.name;
          const baseRetail = parseFloat(prodCard.dataset.retail);
          const baseWholesale = parseFloat(prodCard.dataset.wholesale);
          const goldRetail = parseFloat(prodCard.dataset.retailGold || prodCard.dataset.retail);
          const goldWholesale = parseFloat(prodCard.dataset.wholesaleGold || prodCard.dataset.wholesale);

          let retailVal = goldRetail || baseRetail;
          let wholesaleVal = goldWholesale || baseWholesale;

          if (perProd[pid]) {
            if (typeof perProd[pid].retail === "number") retailVal = perProd[pid].retail;
            if (typeof perProd[pid].wholesale === "number") wholesaleVal = perProd[pid].wholesale;
          }

          const row = document.createElement("div");
          row.className = "admin-price-row";
          row.dataset.productId = pid;
          row.innerHTML = `
            <div class="apr-name">${pname}</div>
            <div class="apr-field">
              <label>Retail
                <input type="number" min="0" step="0.01" class="apr-retail" value="${retailVal}">
              </label>
            </div>
            <div class="apr-field">
              <label>Wholesale
                <input type="number" min="0" step="0.01" class="apr-wholesale" value="${wholesaleVal}">
              </label>
            </div>
          `;
          pricesGrid.appendChild(row);
        });
      }

      if (tier === "platinum") {
        ensurePricesGridBuilt();
      }

      tierSelect.addEventListener("change", () => {
        if (tierSelect.value === "platinum") {
          platinumBox.style.display = "block";
          ensurePricesGridBuilt();
        } else {
          platinumBox.style.display = "none";
        }
      });

      const saveBtn = card.querySelector(".admin-save-btn");
      saveBtn.addEventListener("click", () => {
        const allUsers = loadUsers();
        const idx = allUsers.findIndex(u => u.email === user.email);
        if (idx === -1) return;

        const updatedTier = tierSelect.value;
        const freeDelValue = parseFloat(card.querySelector(".admin-free-delivery").value);
        const wholesaleFromValue = parseFloat(card.querySelector(".admin-wholesale-from").value);

        const updatedUser = { ...allUsers[idx] };
        updatedUser.tier = updatedTier;
        updatedUser.freeDeliveryFrom = isNaN(freeDelValue) ? 300 : freeDelValue;
        updatedUser.wholesaleFrom = isNaN(wholesaleFromValue) ? 50 : wholesaleFromValue;

        if (updatedTier === "platinum") {
          ensurePricesGridBuilt();
          const prices = {};
          pricesGrid.querySelectorAll(".admin-price-row").forEach(row => {
            const pid = row.dataset.productId;
            const r = parseFloat(row.querySelector(".apr-retail").value);
            const w = parseFloat(row.querySelector(".apr-wholesale").value);
            prices[pid] = {
              retail: isNaN(r) ? null : r,
              wholesale: isNaN(w) ? null : w
            };
          });
          updatedUser.platinumPrices = prices;
        } else {
          delete updatedUser.platinumPrices;
        }

        allUsers[idx] = updatedUser;
        saveUsers(allUsers);
        showToast("Customer updated.");

        const current = loadCurrentUser();
        if (current && !current.role && current.email === updatedUser.email) {
          saveCurrentUser(updatedUser);
          applyUserGreeting();
          updateVisiblePricesForTier();
        }
      });
    });
  }

function showToast(message) {
    toast.textContent = message;
    toast.classList.add("show");
    setTimeout(() => {
      toast.classList.remove("show");
    }, 2000);
  }

  // Filtering logic (top menu + pills)
  const cards = document.querySelectorAll(".product-card");

  
  function setView(view) {
    const sections = document.querySelectorAll(".page-section");
    sections.forEach(sec => {
      const page = sec.dataset.page;
      if (!page) return;
      if (view === "home") {
        sec.style.display = (page === "home") ? "" : "none";
      } else if (view === "products") {
        sec.style.display = (page === "products") ? "" : "none";
      } else {
        sec.style.display = (page === view) ? "" : "none";
      }
    });
    if (view === "home") {
      window.scrollTo({ top: 0, behavior: "smooth" });
    } else if (view === "products") {
      const prod = document.getElementById("products");
      if (prod) prod.scrollIntoView({ behavior: "smooth" });
    } else if (view === "about") {
      const sec = document.getElementById("about");
      if (sec) sec.scrollIntoView({ behavior: "smooth" });
    } else if (view === "delivery") {
      const sec = document.getElementById("delivery");
      if (sec) sec.scrollIntoView({ behavior: "smooth" });
    } else if (view === "contact") {
      const sec = document.getElementById("contact");
      if (sec) sec.scrollIntoView({ behavior: "smooth" });
    } else if (view === "signin") {
      const sec = document.getElementById("signin");
      if (sec) sec.scrollIntoView({ behavior: "smooth" });
    }
  }

function applyFilter(filter) {
    cards.forEach(card => {
      const type = card.dataset.type;
      if (filter === "none") {
        card.style.display = "none";
      } else if (filter === "all" || type === filter) {
        card.style.display = "";
      } else {
        card.style.display = "none";
      }
    });
  }

  // Pills
  document.querySelectorAll(".pill").forEach(pill => {
    pill.addEventListener("click", () => {
      document.querySelectorAll(".pill").forEach(p => p.classList.remove("active"));
      pill.classList.add("active");
      const filter = pill.dataset.filter;
      applyFilter(filter);
      document.getElementById("products").scrollIntoView({behavior: "smooth"});
    });
  });

  
  // Products dropdown toggle (click-based so it doesn't disappear on hover gap)
  const productsToggle = document.querySelector(".nav-dropdown-toggle");
  const productsMenu = document.querySelector(".nav-dropdown-menu");
  if (productsToggle && productsMenu) {
    productsToggle.addEventListener("click", (e) => {

      e.stopPropagation();
      productsMenu.classList.toggle("open");
    });
    document.addEventListener("click", (e) => {
      if (!productsMenu.contains(e.target) && e.target !== productsToggle) {
        productsMenu.classList.remove("open");
      }
    });
  }

// Nav product dropdown items
  document.querySelectorAll(".nav-dropdown-item").forEach(item => {
    item.addEventListener("click", (e) => {

      const filter = item.dataset.filter;
      setView("products");
      applyFilter(filter);
      // Sync pills visual state
      document.querySelectorAll(".pill").forEach(p => {
        p.classList.toggle("active", p.dataset.filter === filter);
      });
      // Close dropdown after selection
      const menu = document.querySelector(".nav-dropdown-menu");
      if (menu) menu.classList.remove("open");
    });
  });
(link => {
    link.addEventListener("click", (e) => {

      setView("about");
    });
  });
  document.querySelectorAll(".nav-delivery").forEach(link => {
    link.addEventListener("click", (e) => {

      setView("delivery");
    });
  });
  document.querySelectorAll(".nav-contact").forEach(link => {
    link.addEventListener("click", (e) => {

      setView("contact");
    });
  });

  
  // Top nav behaviour using setView
  document.querySelectorAll(".nav-home").forEach(link => {
    link.addEventListener("click", (e) => {

      setView("home");
    });
  });
  document.querySelectorAll(".nav-about").forEach(link => {
    link.addEventListener("click", (e) => {

      setView("about");
    });
  });
  document.querySelectorAll(".nav-delivery").forEach(link => {
    link.addEventListener("click", (e) => {

      setView("delivery");
    });
  });
  document.querySelectorAll(".nav-contact").forEach(link => {
    link.addEventListener("click", (e) => {

      setView("contact");
    });
  });


    document.querySelectorAll(".nav-admin").forEach(link => {
    link.addEventListener("click", (e) => {

      if (!isAdmin()) {
        alert("Admin access only.");
        return;
      }
      setView("admin");
      buildAdminCustomersUI();
    });
  });


document.querySelectorAll(".nav-signin").forEach(link=>{
  link.addEventListener("click",(e)=>{

    const u = loadCurrentUser();
    if (!u || !u.name) {
      window.location.href = "login.html";
    }
  });
});

// Initial state// Initial state: home view with products hidden until selected from nav
  applyFilter("all");
  setView("home");
  initAuthFlows();
</script>

<!-- Supabase (loaded after site JS to prevent breaking layout if anything fails) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="auth.js"></script>

<script>
// ===== Supabase integration (NON-BREAKING) =====
(function(){
  const qs = (id) => document.getElementById(id);

  async function safeGetUser() {
    try { return await ShrinxaAuth.getCurrentUser(); } catch(e) { return null; }
  }

  async function syncNavbar() {
    const user = await safeGetUser();
    const signins = document.querySelectorAll(".nav-signin");
    const menu = qs("user-menu");
    const nameEl = qs("userMenuName");

    if (user) {
      const p = ShrinxaAuth.getProfileFromUser(user);
      signins.forEach(el => el.style.display = "none");
      if (menu) menu.style.display = "flex";
      if (nameEl) nameEl.textContent = "Hi, " + (p.full_name || p.email || "Customer");
    } else {
      signins.forEach(el => el.style.display = "");
      if (menu) menu.style.display = "none";
    }
  }

  async function fillProfile() {
    const user = await safeGetUser();
    if (!user) return;

    const p = ShrinxaAuth.getProfileFromUser(user);
    const setVal = (id, v) => { const el = qs(id); if (el) el.value = v ?? ""; };

    setVal("profile-name", p.full_name || "");
    setVal("profile-company", p.company || "");
    setVal("profile-email", p.email || "");
    setVal("profile-phone", p.phone || "");
    setVal("profile-address", p.address || "");
    setVal("profile-postal", p.city ? (p.city + (p.province ? ", " + p.province : "")) : "");

    const form = qs("profile-form");
    if (form && !form.__sb_bound) {
      form.__sb_bound = true;
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const patch = {
          full_name: (qs("profile-name")?.value || "").trim(),
          company: (qs("profile-company")?.value || "").trim(),
          phone: (qs("profile-phone")?.value || "").trim(),
          address: (qs("profile-address")?.value || "").trim(),
        };
        const loc = (qs("profile-postal")?.value || "").trim();
        if (loc) {
          const parts = loc.split(",").map(s => s.trim()).filter(Boolean);
          patch.city = parts[0] || "";
          patch.province = parts[1] || "";
        }
        try {
          await ShrinxaAuth.updateProfileMetadata(patch);
          await syncNavbar();
          alert("Profile updated.");
        } catch (err) {
          alert(err?.message || "Failed to update profile");
        }
      });
    }

    const pwForm = qs("password-form");
    if (pwForm && !pwForm.__sb_bound) {
      pwForm.__sb_bound = true;
      pwForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const p1 = (qs("new-password")?.value || "").trim();
        const p2 = (qs("repeat-password")?.value || "").trim();
        if (!p1 || p1.length < 6) return alert("Password must be at least 6 characters.");
        if (p1 !== p2) return alert("Passwords do not match.");
        try {
          const { error } = await ShrinxaAuth.supabaseClient.auth.updateUser({ password: p1 });
          if (error) throw error;
          qs("new-password").value = "";
          qs("repeat-password").value = "";
          alert("Password updated.");
        } catch (err) {
          alert(err?.message || "Failed to update password");
        }
      });
    }
  }

  async function renderHistory() {
    const box = qs("purchase-history-list");
    if (!box) return;

    const user = await safeGetUser();
    if (!user) {
      box.innerHTML = "<div>Please sign in to view your purchases.</div>";
      return;
    }

    try {
      const { data, error } = await ShrinxaAuth.supabaseClient
        .from("orders")
        .select("*")
        .eq("user_id", user.id)
        .order("created_at", { ascending: false });

      if (error) throw error;

      if (!data || !data.length) {
        box.innerHTML = "<div>No purchases recorded yet.</div>";
        return;
      }

      const fmtMoney = (v) => (typeof window.fmt === "function" ? window.fmt(Number(v || 0)) : String(v ?? ""));

      box.innerHTML = data.map(o => {
        const dateStr = o.created_at ? new Date(o.created_at).toLocaleString() : "";
        const inv = o.invoice_number ? ("#" + o.invoice_number) : "";
        const total = fmtMoney(o.total);
        const method = o.payment_method || "";
        const status = o.payment_status || "";
        return `
          <div class="card" style="padding:1rem;margin-bottom:.7rem;border:1px solid rgba(255,255,255,0.08);border-radius:14px;background:rgba(0,0,0,0.2);">
            <div style="display:flex;justify-content:space-between;gap:1rem;flex-wrap:wrap;">
              <div>
                <div style="font-weight:700;">Order ${inv}</div>
                <div style="color:var(--text-muted);font-size:.85rem;">${dateStr}</div>
              </div>
              <div style="text-align:right;">
                <div style="font-weight:700;">${total}</div>
                <div style="color:var(--text-muted);font-size:.85rem;">${method}${status ? " Â· " + status : ""}</div>
              </div>
            </div>
          </div>
        `;
      }).join("");
    } catch (e) {
      console.error(e);
      box.innerHTML = "<div>Unable to load purchase history.</div>";
    }
  }

  // Menu actions: keep your original setView, just call it then hydrate
  document.addEventListener("click", (e) => {
    const item = e.target.closest(".user-menu-item");
    if (!item) return;
    const action = item.dataset.action;
    if (action === "signout") return ShrinxaAuth.logout("index.html");
    if (action === "profile") { if (typeof window.setView === "function") window.setView("profile"); setTimeout(fillProfile, 50); }
    if (action === "history") { if (typeof window.setView === "function") window.setView("history"); setTimeout(renderHistory, 50); }
  });

  document.addEventListener("DOMContentLoaded", async () => {
    await syncNavbar();
    try { ShrinxaAuth.supabaseClient.auth.onAuthStateChange(() => syncNavbar()); } catch(e) {}
  });
})();
</script>

</body>
</html>
